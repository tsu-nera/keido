+++
title = "ğŸ“Clojure API Client Development"
tags = ["WIKI"]
draft = false
+++

ä¸»ã«ã‚µãƒ¼ãƒ“ã‚¹ã®APIã‚’å©ãã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ—ãƒ­ã‚°ãƒ©ãƒ ã®ãƒã‚¦ãƒã‚¦ã¾ã¨ã‚.

ref: [ğŸ“Clojure Web Development]({{< relref "20220118092453.md" >}}) ã‹ã‚‰åˆ†é›¢.

up: [ğŸ“‚Clojure]({{< relref "20220214041907.md" >}}) tags: [ğŸ·Clojure]({{< relref "20211111225741.md" >}}) refs: [ğŸ“Clojure with Twitter Development]({{< relref "20220307193727.md" >}})


## Clojure HTTP Client {#clojure-http-client}

ä¸»ãªã‚¯ãƒ©ã‚¤ã‚¢ãƒ³ãƒˆãƒ©ã‚¤ãƒ–ãƒ©ãƒªã«http-kitã¨clj-httpãŒã‚ã‚‹.

-   <https://github.com/http-kit/http-kit>
-   <https://github.com/dakrone/clj-http>

httpãƒªã‚¯ã‚¨ã‚¹ãƒˆã«é–¢ã—ã¦ã¯ã©ã¡ã‚‰ã‚‚åŒã˜ã“ã¨ãŒã§ãã‚‹. éåŒæœŸç™ºè¡Œã‚‚.

ãŸã ã—ãƒã‚¤ãƒ³ãƒˆã¯websocketãŒtçµ±åˆã•ã‚Œã¦ã„ã‚‹ã‹ã©ã†ã‹.

http-kitã¯2022å¹´ç¾åœ¨ãƒ¡ãƒ³ãƒ†ãƒŠãƒ³ã‚¹çŠ¶æ³ãŒæ€ªã—ãè¦‹ãˆãŸ.


## clj-http {#clj-http}

<https://github.com/dakrone/clj-http>

[Ring]({{< relref "20220118092453.md#clojure-ring-webã‚µãƒ¼ãƒæŠ½è±¡" >}}) ã®å½±éŸ¿ã‚’å—ã‘ã¦ã„ã‚‹ãŸã‚ Request Mapã‚’å…¥åŠ›ã¨ã—ã¦Response Mapã‚’è¿”ã™.


### tips: debug å‡ºåŠ› {#tips-debug-å‡ºåŠ›}

{:debug true} ã‚’Request Mapã«å«ã‚ã‚‹ã¨, æ¨™æº–å‡ºåŠ›ã«Request Mapã®å†…å®¹ãŒè¡¨ç¤ºã•ã‚Œã‚‹.


### tips: clj-httpã«ãŠã‘ã‚‹jsonã®æ‰±ã„ {#tips-clj-httpã«ãŠã‘ã‚‹jsonã®æ‰±ã„}

Clojureã§JSONã‚’æ‰±ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã§ã‚ã‚‹ [darkrone/cheshire](https://github.com/dakrone/cheshire) ã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨, json
ã¨ã®é€£æºãŒã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰ã§ã§ãã‚‹.

-   {:accept :json} ã§ application/jsonã‚’content-typeã«è¨­å®š.
-   {:as :json} ã§ response mapã®bodyã‚’jsonã¨ã—ã¦ãƒ‘ãƒ¼ã‚¹.

ãŸã å®Ÿé¨“ã™ã‚‹ã¨ :as ã¯ :acceptã‚’å…¼ã­ã‚‹ã‚ˆã†ãªã®ã§ :asã ã‘ã¤ã‘ã‚Œã°ã„ã„ã®ã‹ï¼Ÿ


### howto: clj-httpã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’proxyçµŒç”±ã«ã™ã‚‹ã«ã¯ï¼Ÿ {#howto-clj-httpã®ãƒªã‚¯ã‚¨ã‚¹ãƒˆã‚’proxyçµŒç”±ã«ã™ã‚‹ã«ã¯}

Request Mapã« proxy-host, prox-port, proxy-user, proxy-passã‚’å«ã‚ã‚‹.

ref: [clj-http: Proxies](https://github.com/dakrone/clj-http#proxies)


### howto: clj-httpã§ WARN log: Invalid 'expires' attribute {#howto-clj-httpã§-warn-log-invalid-expires-attribute}

request mapã®ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã« **:cookie-policy :standard** ã‚’è¿½åŠ .

ref: [Invalid 'expires' attribute? - GitHub](https://github.com/dakrone/clj-http/issues/325)


## References {#references}

å‹‰å¼·ã®å‚è€ƒã«ç›®ã‚’é€šã—ãŸã‚‚ã®ã®ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯.

-   [Clojureã§Qiita APIã‚’ãŸãŸã - Qiita](https://qiita.com/akthrms/items/42af315089229800aefa)
    -   <https://github.com/akthrms/qiita-client-sample>
    -   Qiitaã‚’å©ãã ã‘ã ã‘ã©ä½™è¨ˆãªã‚‚ã®ãŒãªã„ã®ã§ã‚ˆã„.
-   [Clojure tutorial - boot, basic functions and how to do REST requests](https://joaoptrindade.com/clojure-tutorial-part-1-http-requests)
    -   ã¨ãã«Clojureã®REST requestsã«ç€ç›®ã—ãŸãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«Webè¨˜äº‹.
    -   example of clj-http
    -   <https://github.com/joninvski/clojure-tutorial>
