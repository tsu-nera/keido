+++
title = "ğŸ“Clojure Product Development"
tags = ["WIKI"]
draft = false
+++

up: [ğŸ“‚Clojure Development]({{< relref "20220211141917.md" >}}) tags: [ğŸ·Clojure]({{< relref "20211111225741.md" >}})

Clojureé–‹ç™ºã§ã‚ã‚Œã©ã†ã‚„ã‚‹ã‚“ã ã£ã‘ã¨ã„ã†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã¾ã¨ã‚ã‚‹.

-   refs:
    -   [ğŸ“Clojure Web Development]({{< relref "20220118092453.md" >}}) : Webé–¢ä¿‚ã¯ã“ã£ã¡
    -   [ğŸ“Clojure API Client Development]({{< relref "20220209102028.md" >}}) : Client APIé–¢ä¿‚ã¯ã“ã£ã¡:


## Clojureå‘½åè¦ç´„ {#clojureå‘½åè¦ç´„}

[Clojureã‚¹ã‚¿ã‚¤ãƒ«ã‚¬ã‚¤ãƒ‰](https://totakke.github.io/clojure-style-guide/) ãŒå¤§å¤‰å‚è€ƒã«ãªã‚‹. ã‚ã¨ã¯GitHubã§ä»–äºº-ã®ã‚³ãƒ¼ãƒ‰ãƒªãƒ¼ãƒ‡ã‚£ãƒ³ã‚°.

ã“ã“ã«ã¯ã¨ã‚Šã‚ãˆãšèº«ã«ã¤ã‘ãŸã„åŠªåŠ›ç›®æ¨™ã‚’ãƒ¡ãƒ¢ã—ã¦ã„ã. æœ¬å½“ã¯ã‚¹ã‚¿ã‚¤ãƒ«ã¨ã‹ã¯å€‹äººã®åŠªåŠ›ã«é ¼ã‚‹ã®ã¯ã‚¢ãƒ³ãƒãƒ‘ã‚¿ãƒ¼ãƒ³ã§ãƒ„ãƒ¼ãƒ«ã§ãƒã‚§ãƒƒã‚¯ã™ã‚‹ã®ãŒã„ã„ã‚“ã ã‘ã©ãª...ãã†ã„ã†ãƒ„ãƒ¼ãƒ«ã¯ãŠã„ãŠã„èª¿æŸ».


### é–¢æ•°åã‚„å¤‰æ•°åã¯lisp-case, Protocols/Records/Structs/Typesã¯CaptalCase {#é–¢æ•°åã‚„å¤‰æ•°åã¯lisp-case-protocols-records-structs-typesã¯captalcase}

ref: <https://totakke.github.io/clojure-style-guide/#lisp-case>

refs:

-   <https://totakke.github.io/clojure-style-guide/#CamelCase-for-protocols-records-structs-and-types>
-   <https://github.com/bbatsov/clojure-style-guide/blob/master/README.adoc#naming-protocols-records-structs-and-types>

ãªã‚“ã‹æ—¥æœ¬èªè¨³ã®CamelCaseã¯åŸæ–‡ã¨é•ã†ãª...

CapitalCase is also known as UpperCamelCase, \`CapitalWords and PascalCase.


### private functionsã«ã¯ defn- ã§å°ã‚’ã¤ã‘ã‚‹ {#private-functionsã«ã¯-defn-ã§å°ã‚’ã¤ã‘ã‚‹}

ref: <https://totakke.github.io/clojure-style-guide/#private>


### å‰¯ä½œç”¨ã®æŒã¤é–¢æ•°ã¯!, å¤‰æ›ã‚’ã™ã‚‹é–¢æ•°ã®åç§°ã¯toã§ã¯ãªã-&gt; {#å‰¯ä½œç”¨ã®æŒã¤é–¢æ•°ã¯-å¤‰æ›ã‚’ã™ã‚‹é–¢æ•°ã®åç§°ã¯toã§ã¯ãªã}

e.g.) reset!


### Java Classã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä¸‹ãŒã£ãŸã‚‰^ã§Type Hintsã‚’ã¤ã‘ã‚‹ {#java-classã§ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ãŒä¸‹ãŒã£ãŸã‚‰-ã§type-hintsã‚’ã¤ã‘ã‚‹}

reflectionæŠ‘æ­¢ã«ã‚ˆã‚‹ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«é€Ÿåº¦å‘ä¸Š.

ref: <https://clojure.org/reference/java_interop#typehints>

ã©ã¡ã‚‰ã‹ã¨ã„ã†ã¨ï¼Œä½¿ã†ãªã¨ã„ã†æ„å‘³ã ãªğŸ¤”

&gt;  Normally, one should avoid the use of type hints until there is a known performance bottleneck.

ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã£ã¦ãªã«ï¼Ÿã¨æ€ã£ãŸã‚‰éå»è¨˜äº‹ã‚’æ›¸ã„ã¦ãŸ...

[ğŸ–ŠJava ã®ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã§ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚„ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‹•çš„ç”Ÿæˆã™ã‚‹ | Futurismo](https://futurismo.biz/archives/2715/)


### å®šæ•°ã«ç‰¹åˆ¥ãªè¡¨è¨˜ã‚’ã—ãªã„ {#å®šæ•°ã«ç‰¹åˆ¥ãªè¡¨è¨˜ã‚’ã—ãªã„}

Javaã¨ã‹Pythonã§å®šæ•°ã‚’å¤§æ–‡å­—ã«ã™ã‚‹æ…£ç¿’ã¯æ³¨æ„. Clojureã§ã¯å…¨ã¦ãŒå®šæ•°ãªã®ã§ä¸è¦.

(def MAX-SIZE 10) ; Java style NG!!!


## Clojure: çŠ¶æ…‹ç®¡ç† {#clojure-çŠ¶æ…‹ç®¡ç†}

ã„ã‚ã„ã‚ã‚ã‚‹ãŒãƒŠã‚¦ã„ã®ã¯Integrantã‹ãªï¼Ÿ

-   [stuartsierra/component](https://github.com/stuartsierra/component)
-   [tolitius/mount](https://github.com/tolitius/mount)
-   [weavejester/integrant](https://github.com/weavejester/integrant/projects?type=beta)

çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨ã¯é–¢æ•°å‹ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ å›ºæœ‰ã®ã‚‚ã®ã‹ãªï¼Ÿ Reduxçš„ãª.å¾Œã§èª¿ã¹ãŸã„.


### Clojure: Integrant {#clojure-integrant}

[weavejester/integrant](https://github.com/weavejester/integrant)

-   integrant
    -   **configuration map** ã‚’ã‚‚ã¨ã«ç”Ÿæˆã•ã‚Œã‚‹micro-serviceã®1ã¤ã®å˜ä½.
-   configuration map
    -   keyã®å®šç¾©ã‚’ã¾ãšã™ã‚‹. ã“ã‚Œã¯å…·ä½“çš„ãªå®Ÿè£…ã¸ã¨åˆæœŸåŒ–ã•ã‚Œã‚‹å…¥åŠ›æƒ…å ±.
    -   Clojureã®mapã¨ã—ã¦è¡¨ç¾ã™ã‚‹ã‹EDNãƒ•ã‚¡ã‚¤ãƒ«ã¨ã—ã¦å¤–éƒ¨ãƒ•ã‚¡ã‚¤ãƒ«ã«å®šç¾©ã™ã‚‹.
    -   configuration mapåŒå£«ã¯ **ig/ref** ã§ å‚ç…§ã™ã‚‹ã“ã¨ãŒã§ãã‚‹.
-   ig/init-key ã§ integrant serviceã®åˆæœŸåŒ–ã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿ã¨é–¢æ•°ã‚’å®šç¾©.
-   ig/halt-key!ã§integrant serviceã®init-keyã®å®šç¾©ã‚’ç ´æ£„ã™ã‚‹é–¢æ•°ã‚’å®šç¾©.
-   ig/initã«configuration mapã‚’æ¸¡ã™ã“ã¨ã§, ä¾å­˜é–¢ä¿‚ã«å¾“ã£ã¦ integrant ã‚’åˆæœŸåŒ–.
-   init/halt!ã§ ç ´æ£„.

<!--listend-->

```clojure
(defmethod ig/init-key :handler/greet [_ {:keys [name]}]
  (fn [_] (resp/response (str "Hello " name))))
```

-   {:keys [name]}ã¯Clojure åˆ†é…æŸç¸›ã®è¨˜æ³•.
    -   ref: [ğŸ“Destructuring]({{< relref "20220116094551.md#clojure-åˆ†é…æŸç¸›--destructuring" >}})
-   keyã« ::hogeã¿ãŸã„ãª 2ã¤ã®ã‚³ãƒ­ãƒ³ã‚’ã¿ã‹ã‘ã‚‹. ::hogeã¯ :(namespace)/hogeã®æ„å‘³.
    -   REPLã§è©•ä¾¡ã™ã‚‹ã¨ã‚ã‹ã‚‹, reader syntax.

references:

-   [Integrantå…¥é–€(1) - Integrantã®åŸºæœ¬ - ayato-p](https://scrapbox.io/ayato-p/Integrant%E5%85%A5%E9%96%80(1)_-_Integrant%E3%81%AE%E5%9F%BA%E6%9C%AC)
-   [ã¯ã˜ã‚ã¦ã®Duct - Uzabase Tech](https://tech.uzabase.com/entry/2018/04/03/115236)
    -   integrantã«ã¤ã„ã¦ã‚‚æ›¸ã‹ã‚Œã¦ã‚‹.


#### memo: Javaã‹ã‚‰ã®ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼ {#memo-javaã‹ã‚‰ã®ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼}

ã‚¯ãƒ©ã‚¹ã¨ã„ã†ã‚‚ã®ã‚’å˜ãªã‚‹æŠ½è±¡ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¨æ‰ãˆã‚‹ã¨,
ã‚¯ãƒ©ã‚¹ã«ã¯å±æ€§ã¨ã—ã¦ã®å€¤ã¨é–¢æ•°å€¤ã®é›†åˆã§ã‚ã‚Š,
ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã¨ã¯ãã‚Œã‚’ãƒ¡ãƒ¢ãƒªä¸Šã«é ˜åŸŸç¢ºä¿ã—ãŸçŠ¶æ…‹.

ig/init-keyã§ã‚„ã£ã¦ã„ã‚‹ã“ã¨ã¯å€¤ã¨ãã®åˆæœŸåŒ–é–¢æ•°ã®pairã®bindingã§ã‚ã‚Š,
ig/init-keyã§å®šç¾©ã—ãŸpairã®é›†åˆã‚’ig/initã§ã¾ã¨ã‚ã¦åˆæœŸåŒ–ã—ã¦ã„ã‚‹.

ãã†ã™ã‚‹ã¨, ig/init-keyã§åˆæœŸåŒ–ã—ãŸãã‚Œãã‚Œã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ï¼‘ã¤ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã«
bindingã—ã¦ç®¡ç†ã—ã¦ã„ã‚‹ã‚ˆã†ã«ã‚‚ã¿ãˆã‚‹.
ç®¡ç†ã¨ã„ã†ã“ã¨ã§, suspend, resume,
haltã¯ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’GoF Command patternã§æ‰±ã†ã‚ˆã†ãªã‚‚ã®ã¨ã—ã¦æ‰ãˆã‚Œã°ç´å¾—ãŒã„ã.

(ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼ã¨ã—ã¦é¡æ¨ã—ãŸã ã‘ã§å®Ÿè£…ã‚’èª­ã‚“ã§ã¯ãªã„...å¾Œã§èª­ã‚€).


### Clojure: Duct {#clojure-duct}

<https://github.com/duct-framework/duct>

Integrantã‚’ãƒ™ãƒ¼ã‚¹ã«ã—ãŸæ‹¡å¼µæ©Ÿèƒ½ã‚’æä¾›.
Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã§ã¯ãªãã‚‚ã£ã¨æ±ç”¨çš„ãªã‚‚ã®, ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã®ãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯.

-   [Ductãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«å…¥é–€](https://www.slideshare.net/KentOhashi/duct-module-getting-started)


#### memo: Javaã‹ã‚‰ã®ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼ {#memo-javaã‹ã‚‰ã®ã‚¢ãƒŠãƒ­ã‚¸ãƒ¼}

å°ã•ãªæ§‹æˆã®ã‚·ã‚¹ãƒ†ãƒ ã‚’Javaã§ä½œæˆã™ã‚‹ãªã‚‰ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ã”ã¨ã«ã‚¯ãƒ©ã‚¹åˆ†å‰²ã™ã‚‹ãŒ,
Ductã¯ã‚¯ãƒ©ã‚¹ã«åˆæœŸåŒ–ãƒ‡ãƒ¼ã‚¿ã¨ãã®æ–¹æ³•ã‚’å®šç¾©ã™ã‚‹ãŸã‚ã®ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’å®šç¾©ã™ã‚‹ã‚ˆã†ãªã‚‚ã®ã‹?
è²¬å‹™ã‚’æ„è­˜ã—ãŸã‚¯ãƒ©ã‚¹è¨­è¨ˆã¨ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³åˆ†å‰².


## Clojure: Logging {#clojure-logging}

Javaã®è³‡ç”£ã‚’ä½¿ã†ã‹å¦ã‹ãŒæ¡ç”¨ã®ãƒã‚¤ãƒ³ãƒˆã‹ãªï¼Ÿ
Javaã®ãƒ­ã‚®ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯æ­´å²ãŒã‚ã‚‹.
ãƒ­ã‚°ã¯ViewerãŒã‚ˆã„ã¨ãƒ¯ã‚¯ãƒ¯ã‚¯ã™ã‚‹ã‹ã‚‰ãª.


### tools.logging {#tools-dot-logging}

<https://github.com/clojure/tools.logging>

clojure tools.logging libaryã§Javaã®è³‡ç”£ã‚’æ´»ç”¨.

ref: [ğŸ–ŠLogbackã®ãƒ­ã‚°ã‚’è¦‹ã‚„ã™ãã™ã‚‹æ–¹æ³•(ãƒ•ã‚¡ã‚¤ãƒ«ã‚’grep, Lilith) | Futurismo](https://futurismo.biz/archives/6825/)


### timbre {#timbre}

Pure Clojure/Script logging library.

<https://github.com/ptaoussanis/timbre>

[slf4j-timbre](https://github.com/fzakaria/slf4j-timbre) ã‚’ã¤ã‹ã†ã¨Javaã®ãƒ­ã‚®ãƒ³ã‚°ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¨é€£æºå¯èƒ½.

ãªã‚“ã‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã‚ã‹ã‚Šã«ãã„ãª...

æ—¥æœ¬ã®æ™‚åˆ»è¨­å®šä¾‹:

```clojure
(def timbre-config {:timestamp-opts {:pattern  "yyyy-MM-dd HH:mm:ss,SSS"
                                     :locale   (java.util.Locale. "ja_JP")
                                     :tiemzone (java.util.TimeZone/getTimeZone "Asia/Tokyo")}})
(timbre/merge-config! timbre-config)
```


## Clojure Architecture {#clojure-architecture}

ref: [ğŸ“Clean Architecture]({{< relref "20220228062229.md" >}})

-   [ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°è¨€èªã¨ã‚·ã‚¹ãƒ†ãƒ ãƒ‡ã‚¶ã‚¤ãƒ³](https://www.slideshare.net/tsutomuyano/ss-250915366)
    -   Clojureã®è¨­è¨ˆæŒ‡é‡ by t_yano.
    -   namespaceã‚’ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ã™ã‚‹ã‚Œã°ã„ã„.
        -   ãƒ‡ãƒ¼ã‚¿ã‚’é–¢å¿ƒé ˜åŸŸã¨ã—ã¦ãã“ã«å¯¾ã™ã‚‹æ“ä½œãŒé–¢æ•°.
        -   ãƒ‰ãƒ¡ã‚¤ãƒ³ã«æ“ä½œã‚’é–¢æ•°å®šç¾©ã™ã‚Œã°ã„ã„.
-   [ã‚·ã‚¹ãƒ†ãƒ ã®è¤‡é›‘ã•ã¯ã©ã“ã‹ã‚‰æ¥ã‚‹ã®ã‹ â€“ Out of the tar pitã‚’èª­ã‚€ - Uzabase Tech](https://tech.uzabase.com/entry/2021/05/20/141950)
    -   ã“ã‚Œã‚‚by t_yano.
-   ref: [ğŸ“Clojure Records]({{< relref "20220117172324.md#clojure-data-types" >}})
    -   Clojure Recordã‚’ç©æ¥µçš„ã«ã¤ã‹ã†.
-   [REPLãƒ©ã‚¤ãƒ•ã‚’ã‚‚ã£ã¨å¿«é©ã«](https://www.slideshare.net/sohta/repl-40110261)
    -   Component å˜ä½ã§ã‚·ã‚¹ãƒ†ãƒ ã‚’ã¤ãã‚‹ã¨ã„ã†ã‚¢ã‚¤ãƒ‡ã‚¢, ãªã‚‹ã»ã©ğŸ¤”


## Others {#others}

-   [How to Name Clojure Functions â€“ Digital Digressions by Stuart Sierra](https://stuartsierra.com/2016/01/09/how-to-name-clojure-functions)
    -   é–¢æ•°åã©ã†ã™ã‚‹ã‹å•é¡Œ.
