+++
title = "ğŸ“Clojure DX"
tags = ["WIKI"]
draft = false
+++

tags: [ğŸ·Clorljure]({{<relref "20211111225741.md#" >}}) [ğŸ·Emacs]({{<relref "20220112095806.md#" >}})

Clojureé–‹ç™ºã‚’ã™ã‚‹ã¨ãã®Developer Experienceå‘ä¸Šã®ã‚ã‚Œã“ã‚Œ.

ä¸»ã«Clojureé–‹ç™ºã«é–¢ã‚ã‚‹ãƒ„ãƒ¼ãƒ«ã‚„ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¾ã¨ã‚.

Clojure, ã¨ã„ã†ã‚ˆã‚Šã¯Lispãªã‚‰ã¾ãšRDD. åˆ¥ãƒšãƒ¼ã‚¸ã«ã¦ã¾ã¨ã‚!

ref: [ğŸ“Clojure REPL Driven Development]({{<relref "20220117205249.md#" >}})


## Emacs CIDER {#emacs-cider}

<https://github.com/clojure-emacs/cider>

Emacsã§Clojureé–‹ç™ºã‚’ã™ã‚‹ã¨ãã®ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰.

quick reference:

<https://github.com/clojure-emacs/cider/blob/master/refcard/cider-refcard.pdf>


### ã‚³ãƒãƒ³ãƒ‰è©³ç´° {#ã‚³ãƒãƒ³ãƒ‰è©³ç´°}

-   C-c l ' cider-jack-in REPLèµ·å‹• & æ¥ç¶š
-   C-c C-zã§ REPL - Editoré–“ã‚’ç§»å‹•.
-   C-c C-c ã§ç¾åœ¨ã®å®šç¾©ã‚’è©•ä¾¡.
-   C-c C-e ã§ãƒ•ã‚©ãƒ¼ãƒ ã®æœ«å°¾ã®æ‰‹å‰ã‹ã‚‰è©•ä¾¡.
-   C-c M-p ã§ç¾åœ¨ã®å®šç¾©ã‚’REPLã«é€ä¿¡.
-   M-. å®šç¾©ã«ç§»å‹•.
-   C-c C-d C-d documentã‚’ã¿ã‚‹.
-   jack-inã—ã¦ã„ã‚‹çŠ¶æ…‹ã§2charãã‚‰ã„æ‰“ã¡è¾¼ã‚“ã§ C-iã§è£œå®Œå€™è£œãŒã§ã‚‹.
-   C-c M-i ã§ cider-inspectorã‚’èµ·å‹•, defã®ä¸­èº«ãŒåˆ¥ãƒãƒƒãƒ•ã‚¡ã«è¡¨ç¤ºã•ã‚Œã‚‹.
-   C-c SPC: clojure-align, alignã‚’è‡ªå‹•æ•´å½¢.
-   Evaluation
    -   M-x cider-pprint-last-eval-to-comment
        -   å¼ã®è©•ä¾¡çµæœãŒã‚³ãƒ¡ãƒ³ãƒˆã¨ã—ã¦æ›¸ã‹ã‚Œã‚‹.
        -   Design Journalã¨ã—ã¦ã¯ä¾¿åˆ©ãªæ©Ÿèƒ½ã‹ã‚‚.
        -   C-u C-x C-e ã§ã‚‚å¯èƒ½.
    -   M-x cider-pprint-defun-to-comment
        -   ã“ã‚Œã¯ãƒ•ã‚©ãƒ¼ãƒ ã®å…ˆé ­ã§è©•ä¾¡ã™ã‚‹ã¨æ¬¡ã®è¡Œã«çµæœè¡¨ç¤º.
-   cider-repl-set-ns: namespaceã‚’replã«è¨­å®š.


### tips: cider-jack-inã§ã‚«ã‚¹ã‚¿ãƒ ã®ä¾å­˜ã‚’è¨­å®š {#tips-cider-jack-inã§ã‚«ã‚¹ã‚¿ãƒ ã®ä¾å­˜ã‚’è¨­å®š}

ä¸€å¿œcider-jack-inã‚’ã™ã‚‹ã¨ä¾å­˜é–¢ä¿‚ã‚’ã‚ˆã‚ã—ãè§£æ±ºã—ã¦ãã‚Œã‚‹ãŒ,
productionã«å«ã‚ãªã„developmentã®ä¾å­˜é–¢ä¿‚ã¯è‡ªå‹•ã§è§£æ±ºã•ã‚Œãªã„.

.dir-locals.elã« cider-clojure-cli-global-optionsã‚„
cider-clojure-cli-aliasesã«è¿½åŠ ã®è¨­å®šã‚’æ›¸ã.

ä¾‹ãˆã°, deps.ednã®aliasã« :devã®ã‚ˆã†ãªå®šç¾©ãŒã‚ã‚Œã°,

```emacs-lisp
((clojure-mode . ((cider-clojure-cli-aliases . "dev"))))
```

ref: [Practicalli: CIDER jack-in to Clojure CLI projects from Spacemacs](https://practical.li/blog/posts/cider-jack-in-to-clojure-cli-projects-from-spacemacs/)


## Emacs smartparens {#emacs-smartparens}

<https://github.com/Fuco1/smartparens>

Emacsã§Så¼ã‚’æ“ä½œã™ã‚‹.

pareditã‚ˆã‚Šã‚‚smartparensã®ã»ã†ãŒæœ€è¿‘ç™»å ´ã—ãŸã‚ˆã†ãªã®ã§ã“ã¡ã‚‰ã‚’ã¤ã‹ã†.

[doom emacsã® defaultè¨­å®š](https://github.com/hlissner/doom-emacs/blob/master/modules/config/default/%2Bemacs-bindings.el)

-   (, [, {ãªã©ã§è‡ªå‹•ã§é–‰ã˜ã‚«ãƒƒã‚³ãŒæŒ¿å…¥ã•ã‚Œã‚‹.
-   block movement
    -   ()ã®ä¸­ã§)ã‚’å…¥åŠ›ã™ã‚‹ã¨ï¼Œç¾åœ¨ã®)ã®æœ«å°¾ã«é£›ã¶.
    -   []ã®ä¸­ã§]ã‚’å…¥åŠ›ã™ã‚‹ã¨ï¼Œç¾åœ¨ã®]ã®æœ«å°¾ã«é£›ã¶.
-   Navigation
    -   C-M-a: sp-beggining-of-sexp ç¾åœ¨ã®Så¼ã®å…ˆé ­ã¸ç§»å‹•.
    -   C-M-e: sp-end-of-sexpç¾åœ¨ã®Så¼ã®æœ«å°¾ã¸ç§»å‹•.
    -   C-M-f: sp-forward-sexp æ¬¡ã®Så¼ã«ç§»å‹•
    -   C-M-b: sp-backward-sexp å‰ã®Så¼ã«ç§»å‹•
    -   C-M-n: sp-next-sexp
    -   C-M-p: sp-previous-sexp
    -   C-M-u: sp-up-sexp ç¾åœ¨ã®Så¼ã®ã²ã¨ã¤å¤–å´ã®Så¼ã®æœ«å°¾ã¸ç§»å‹•.
    -   C-M-d: sp-donw-sexp ç¾åœ¨ã®Så¼ã®ã²ã¨ã¤å†…å´ã®Så¼ã®å…ˆé ­ã¸ç§»å‹•.
    -   C-M-k: sp-kill-sexp ç¾åœ¨ã®Så¼ã®å†…å´ã‚’å‰Šé™¤.
    -   C-M-t: sp-transpose-sexp
-   wrapping/unwrapping
    -   C-M-Spaceã§ç¾åœ¨ã®éƒ¨åˆ†ã‹ã‚‰wordã®æœ«å°¾ã¾ã§ã‚’ãƒãƒ¼ã‚¯.
        -   (ã¨ã‹[ã§ãƒãƒ¼ã‚¯ã—ãŸéƒ¨åˆ†ã‚’å›²ã‚€.
    -   C-M-<backspace>: sp-splice-sexp
        -   ç¾åœ¨ã®éƒ¨åˆ†ã®å‰ã®Så¼ã‚‚ã‚ã¨ã‚‚å‰Šé™¤.

ã“ã®ï¼•ã¤ã‚’è¦šãˆã‚‹ã ã‘ã§ã€ä½œæ¥­åŠ¹ç‡ãŒä¸ŠãŒã‚ŠãŠã™ã™ã‚ã•ã‚Œã¦ã„ã‚‹.

-   Slurp ï¼ˆéš£ã®æ‹¬å¼§ã‚’å¸ã„è¾¼ã‚€ï¼‰
-   Barf ï¼ˆæ‹¬å¼§ã‚’è¿½ã„å‡ºã™ï¼‰
-   ã‚«ãƒƒãƒˆ ï¼ˆæ‹¬å¼§å˜ä½ã§ã®ã‚«ãƒƒãƒˆï¼‰
-   ã‚³ãƒ”ãƒ¼ ï¼ˆæ‹¬å¼§å˜ä½ã§ã®ã‚³ãƒ”ãƒ¼ï¼‰
-   å‰Šé™¤ ï¼ˆæ‹¬å¼§ã‚’ä¸¸ã”ã¨æ¶ˆã™ï¼‰

ref: [ã„ã¾ã©ãã®Clojureã®ã¯ã˜ã‚ã‹ãŸ - ç´™ç®±](https://boxofpapers.hatenablog.com/entry/2018/10/06/210602)

refs:

-   <https://github.com/Fuco1/smartparens>
-   <https://ebzzry.com/en/emacs-pairs/>
-   <http://kimi.im/2021-11-27-sexp-operations-in-emacs>


## Leiningen {#leiningen}

<https://github.com/technomancy/leiningen>

Clojureãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆç®¡ç†ãƒ„ãƒ¼ãƒ«. makeçš„ãª.


### howto: Javaå¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã„ã‚Œã‚‹ã«ã¯ï¼Ÿ {#howto-javaå¤–éƒ¨ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ã„ã‚Œã‚‹ã«ã¯}

[<groupId>/<artifactId> <version>] ã¨ã„ã†è¨˜æ³•ã§project.cljã®dependenciesã«è¿½åŠ .

---

ã“ã‚ŒãŒ,

```xml
<dependency>
  <groupId>com.google.cloud</groupId>
  <artifactId>google-cloud-firestore</artifactId>
  <version>3.0.2</version>
</dependency>
```

ã“ã†ãªã‚‹.

```clojure
[com.google.cloud/google-cloud-firestore "3.0.2"]
```


### howto: lein uberjarã§The Main-Class specified does not exist within the jar {#howto-lein-uberjarã§the-main-class-specified-does-not-exist-within-the-jar}

main ã® core.cljã®nsã«(:gen-class)ã‚’è¿½åŠ .

> Warning: The Main-Class specified does not exist within the jar. It may not be executable as expected. A gen-class directive may be missing in the namespace which contains the main method, or the namespace has not been AOT-compiled.


## Clojure CLI tools.deps {#clojure-cli-tools-dot-deps}

<https://clojure.org/reference/deps%5Fand%5Fcli>

-   leiningenã‚ˆã‚Šã‚·ãƒ³ãƒ—ãƒ«ã§ã‚ã‚‹ã“ã¨ãŒç‰¹å¾´.
    -   åŸºæœ¬çš„ã«ã¯ paths/dependencies/aliasesã ã‘è¦šãˆã‚Œã°åŸºæœ¬ã¯ã§ãã‚‹.
    -   leiningenã‚ˆã‚Šå­¦ç¿’ã‚³ã‚¹ãƒˆã¯ä½ã„.
    -   cljã‚³ãƒãƒ³ãƒ‰ã§REPLèµ·å‹•.
    -   clojureã‚³ãƒãƒ³ãƒ‰ã§ .cljãƒ•ã‚¡ã‚¤ãƒ«ã‚’å®Ÿè¡Œ.
-   deps.ednãƒ•ã‚¡ã‚¤ãƒ«ã§è¨˜è¿°.
    -   pathsã«clojureã®ã‚³ãƒ¼ãƒ‰ã®rootã‹ã‚‰ã®ç›¸å¯¾ãƒ‘ã‚¹ã‚’è¨˜è¿°.
    -   dependenciesã«ä¾å­˜ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’è¨˜è¿°.
    -   aliasesã«custom command ã‚’è¨˜è¿°.
        -   ãŸã¨ãˆã° clj (-X/-M/-A):hogehoge ã¨ã„ã†ã‚ˆã†ãªã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚’æ°—è»½ã«å®šç¾©ã§ãã‚‹.
        -   npxã®ã‚ˆã†ãªcommand runnerã¨ã—ã¦ã¤ã‹ãˆã‚‹ã‹ãªï¼Ÿï¼Ÿ
-   Rich HickeyãŒã“ã‚Œã‹ã‚‰ç†±æ„ã‚’å…¥ã‚ŒãŸã„ã¨ã‹.
    -   2022ã§ãƒ¡ã‚¸ãƒ£ãƒ¼ãªã®ã¯leiningenã§ã‚ã‚‹ã‚‚ã®ã®ã“ã‚Œã‹ã‚‰é€†è»¢ã®å¯èƒ½æ€§ã¯ã‚ã‚‹.
        -   ä½“æ„Ÿã§deps.ednã®GitHub repoã¯å¢—ãˆã¦ã„ã‚‹.


### references {#references}

-   [Clojure + deps.edn, a basic guide | Tomek WaÅ‚kuski](https://tomekw.com/clojure-deps-edn-a-basic-guide/)
-   [clojure CLI (tools.deps)ã‚’ä½¿ã„ã‚„ã™ãã™ã‚‹ãŸã‚ã®Tips - Qiita](https://qiita.com/k2nakamura/items/03eed17a06a4b963dac5)
-   [Clojure CLIã§Clojarsã«ãƒ‡ãƒ—ãƒ­ã‚¤ã™ã‚‹ - Qiita](https://qiita.com/totakke/items/e20405be6c2cf55ec9ac)


### tools.build {#tools-dot-build}

jar/uberjarã®ä½œæˆã«ã¯ tools.buildã‚’ã¤ã‹ã†ã®ãŒä»Šé¢¨(2022~)

-   <https://github.com/clojure/tools.build>
-   <https://clojure.org/guides/tools%5Fbuild>

refs:

-   <https://clojure.org/news/2021/07/09/source-libs-builds>
-   <https://github.com/seancorfield/depstar> (~2021)
-   [fogus: Clojure builds as an amalgamation of orthogonal parts](http://blog.fogus.me/2021/07/20/clojure-builds-as-an-amalgamation-of-orthogonal-parts/)
    -   <https://twitter.com/athos0220/status/1417640780303278082>
    -   <https://twitter.com/athos0220/status/1411258058265694216>


## References {#references}

-   ğŸ”—[Spacemacsã§Clojureã‚’æ›¸ããŸã‚ã«åƒ•ãŒè¡Œã£ãŸè¨­å®š - ayato-p](https://scrapbox.io/ayato-p/Spacemacs%E3%81%A7Clojure%E3%82%92%E6%9B%B8%E3%81%8F%E3%81%9F%E3%82%81%E3%81%AB%E5%83%95%E3%81%8C%E8%A1%8C%E3%81%A3%E3%81%9F%E8%A8%AD%E5%AE%9A)
-   æ˜”ã®ã‚ãŸã—ã®è¨˜äº‹ï¼Œã‚‚ã†æƒ…å ±ãŒå¤ã„(2016)
    -   [ğŸ–ŠEmacs ã§ Clojoure ã®é–‹ç™ºç’°å¢ƒã‚’æ§‹ç¯‰ | Futurismo](https://futurismo.biz/archives/5742/)
