+++
title = "ğŸ“Clojure Syntax"
tags = ["WIKI"]
draft = false
+++

-   up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})
-   refs:
    -   [clojure.org - syntax](https://www.clojure.org/guides/learn/syntax)

Clojureè¨€èªã«ãŠã‘ã‚‹ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã‚’æ‰±ã†.

ãƒ•ã‚©ãƒ¼ãƒ ã¯ [ğŸ“Clojure ãƒ•ã‚©ãƒ¼ãƒ ]({{< relref "20220505210059.md" >}}) ã‚’å‚ç…§.


## Clojure: ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­ | Reader Macros {#clojure-ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­-reader-macros}

cf. [ğŸ“Clojure Macros]({{< relref "20220302111024.md" >}})


## Clojure: Threading Macros {#clojure-threading-macros}

-   ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­.
-   åŸºæœ¬çš„ã«ã¯ **->** ã¨ **->>** ã‚’ã¤ã‹ã†.
-   å…¥ã‚Œå­æ§‹é€ ã®é–¢æ•°å‘¼ã³å‡ºã—ã‚’é€æ¬¡å‡¦ç†ãªå‘¼ã³å‡ºã—ã«å¤‰ãˆã‚‹.

refs:

-   [clojure.org - Threading Macros Guide](https://clojure.org/guides/threading_macros)
-   [ã‚¹ãƒ¬ãƒƒãƒ‰ãƒã‚¯ãƒ­ã‚’æ•´ç†ã™ã‚‹ - ç´™ç®±](https://boxofpapers.hatenablog.com/entry/threading_macros)


### thread-first (->) ã¨ thread-last (->>) {#thread-first-----ã¨-thread-last}

-> ã‚‚ ->>ã‚‚1ã¤ç›®ã®ãƒ•ã‚©ãƒ¼ãƒ ã‚’åˆæœŸå€¤ã«ã—ã¦2ã¤ç›®ã®ãƒ•ã‚©ãƒ¼ãƒ ã‹ã‚‰é€æ¬¡é©ç”¨ã—ã¦ã„ã.

->ã¯ãƒ•ã‚©ãƒ¼ãƒ ã®ç¬¬ä¸€å¼•æ•°ã«å¼•æ•°ãŒå…¥ã‚‹. ä¸€æ–¹, ->>ã¯æœ€çµ‚å¼•æ•°ã«å¼•æ•°ãŒå…¥ã‚‹.

->> åˆ©ç”¨ã™ã‚‹ã‚±ãƒ¼ã‚¹ã¯ç¬¬ä¸€å¼•æ•°ã«é«˜éšé–¢æ•°ã‚’å—å–ã‚Šæœ«å°¾ã«ãƒªã‚¹ãƒˆã‚’å—ã‘å–ã‚‹ã‚ˆã†ãªé–¢æ•°ã§ã‚ã‚‹.(map, filter, reduce...)

see also: [ğŸ’¡Clojureãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œé–¢æ•°ã®åˆ†é¡]({{< relref "20220116080205.md#clojureãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œé–¢æ•°ã®åˆ†é¡" >}})


### tips: as-> clojure thread-firstã¨thead-lastã‚’æ··åœ¨ã•ã›ã‚‹ {#tips-as-clojure-thread-firstã¨thead-lastã‚’æ··åœ¨ã•ã›ã‚‹}

thread-as or as->ã‚’ã¤ã‹ã†ã“ã¨ã§, æ··åœ¨ã•ã›ã‚‰ã‚Œã‚‹.

```clojure
(-> [10 11]
    (conj 12)
    (as-> xs (map - xs [3 2 1]))
    (reverse))
; (11 9 7)
```


### tips: cond-> æ¡ä»¶ã¤ãã‚¹ãƒ¬ãƒƒãƒ‰ãƒã‚¯ãƒ­ {#tips-cond-æ¡ä»¶ã¤ãã‚¹ãƒ¬ãƒƒãƒ‰ãƒã‚¯ãƒ­}

cond->ã¯åˆæœŸå€¤ã¨(æ¡ä»¶, å‡¦ç†)ã®ãƒªã‚¹ãƒˆã‚’å—ã‘ã‚‹.
æ¡ä»¶ãŒçœŸã®ã¨ãã®ã¿å‡¦ç†ã¯ã•ã‚Œã‚‹.

```clojure
(cond-> (åˆæœŸå€¤)
  (æ¡ä»¶) (å‡¦ç†)
  (æ¡ä»¶) (å‡¦ç†)
  (æ¡ä»¶) (å‡¦ç†))
```


### Emacs clojure-mode: M-x clojure-thread {#emacs-clojure-mode-m-x-clojure-thread}

Emacs clojure-modeã® threadingãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ã‚µãƒãƒ¼ãƒˆ.

ref: <https://github.com/clojure-emacs/clojure-mode/#refactoring-support>

-   clojure-unwind/clojure-unwind-all:
    -   threading expressionã‚’è§£ã.
-   clojure-thread-first-all: -> ã¸å¤‰æ›.
-   clojure-thread-last-all: ->> ã¸å¤‰æ›.

threading macrosã‚’ç†è§£ã™ã‚‹ã«ã¯,
->> ã®å†…å´ã§ M-x clojure-unwind-allã‚’å©ãã¨ã‚¹ãƒ¬ãƒƒãƒ‡ã‚£ãƒ³ã‚°ãƒã‚¯ãƒ­ã‚’ä½¿ã‚ãªã„å ´åˆã«å¤‰æ›ã•ã‚Œã‚‹. ã‚‚ã¨ã«æˆ»ã™ã«ã¯, M-x clojure-thread-last-all.


### ğŸ’¡memo: Clojure Threading Macrosã¯R-langã®dplyrã®pipeè¨˜æ³•ã«ä¼¼ã¦ã„ã‚‹ {#memo-clojure-threading-macrosã¯r-langã®dplyrã®pipeè¨˜æ³•ã«ä¼¼ã¦ã„ã‚‹}

ã“ã‚Œã¯ ç¾½é³¥æ•™ã®dplyrã«ä¼¼ã¦ãªã„ã‹ï¼Ÿ

ref:

-   [ç¾½é³¥æ•™ã®ã™ã‚ã‚ ï½dplyrç·¨ï½ | kitayama lab](https://kitayamalab.wordpress.com/2016/05/16/%E7%BE%BD%E9%B3%A5%E6%95%99%E3%81%AE%E3%81%99%E3%82%9D%E3%82%81-%EF%BD%9Edplyr%E7%B7%A8%EF%BD%9E/)
-   [ç¾½é³¥æ•™å…¥ä¿¡ã®ã™ã‚ã‚ - Qiita](https://qiita.com/uri/items/a66b682507181baa0d50)

ãã—ã¦ã“ã®è¨˜æ³•ã®å¼·åŠ›ãªé­…åŠ›ãŒãƒ‡ãƒ¼ã‚¿åˆ†æã«ãŠã„ã¦Rè¨€èªã‚’Pythonã‚ˆã‚Šã‚‚å¥½ã‚€äººãŒã„ã‚‹ã‚ˆã†ã«, Clojureã«ãŠã„ã¦ã‚‚å¤§å¤‰é­…åŠ›çš„ã«é•ã„ãªã„.


### ğŸ’¡memo: threadingã¨ã¯ã‚ãŸã—ã§ã‚ã‚‹ {#memo-threadingã¨ã¯ã‚ãŸã—ã§ã‚ã‚‹}

theading = ç³¸, ç­‹é“. ã“ã‚Œã¯ã¤ã¾ã‚Š, ã‚ãŸã—ã§ã¯ãªã„ã‹ï¼Ÿ

ref: [ğŸ“çµŒé“ã¨ã¯Threadã§ã‚ã‚‹]({{< relref "20220209051354.md" >}})


## Clojure: MetaData {#clojure-metadata}

Clojureã®Symbolã‚„Collectionã«ã¯, MetaDataã¨å‘¼ã°ã‚Œã‚‹ãƒ‡ãƒ¼ã‚¿ã‚’mapã¨ã—ã¦ä»˜ä¸ã—ã¦å‚ç…§ã™ã‚‹ã“ã¨ãŒã§ãã‚‹.

MetaDataã® ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­ã¯ **^** ã¿ãŸã„ãªhatè¡¨è¨˜.

setterã¨ã—ã¦ã¯, (def ^{:hoge 1} x) ã®ã‚ˆã†ã«, defã‚’åˆ©ç”¨ã™ã‚‹.

ã•ã‚‰ã«, (def ^:huga y) ã®ã‚ˆã†ã«æ›¸ã‹ã‚Œã‚‹ã“ã¨ã‚‚å¤šã„ãŒ, ã“ã‚Œã¯ (def ^{:huga true} y)ã¨åŒã˜æ„å‘³. mapã®è¡¨è¨˜ãŒçœç•¥ã•ã‚Œã¦ keywordã®ã¿ãŒç¾ã‚Œã¦ã„ã‚‹.

MetaDataã®ä¸€è¦§ã‚’è¡¨ç¤ºã™ã‚‹ã¨ãã¯, **meta** ãƒã‚¯ãƒ­ã‚’åˆ©ç”¨ã™ã‚‹.

```clojure
user> (meta #'x)
;; =>
{:line 12,
 :column 7,
 :file "*cider-repl repo/kotori-clj:localhost:38291(clj)*",
 :name x,
 :ns #namespace[user]}
```

refs:

-   [clojure.org - Metadata](https://clojure.org/reference/metadata)
-   [clojure.org - The Reader - Metadata(^)](https://clojure.org/reference/reader#_metadata)


## Active Recalls {#active-recalls}


### Clojure Threading Macrosã«ãŠã„ã¦ ->ã¨->>ã®é•ã„ã¯ãªã‚“ã§ã™ã‹? {#clojure-threading-macrosã«ãŠã„ã¦-ã¨-ã®é•ã„ã¯ãªã‚“ã§ã™ã‹}

->ã¯ç¬¬ä¸€å¼•æ•°ã«å¼•æ•°ãŒå…¥ã‚‹ï¼Œ->>ã¯æœ€çµ‚ä½ç½®ä¼¼å¼•æ•°ãŒã¯ã„ã‚‹.


### Clojureã®MetaDataã®ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojureã®metadataã®ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­ã¯ãªã‚“ã§ã™ã‹}

^
