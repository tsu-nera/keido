+++
title = "ğŸ“Clojure Web Development"
tags = ["WIKI"]
draft = false
+++

Clojureã«ã‚ˆã‚‹Webé–‹ç™ºãƒã‚¦ãƒã‚¦ã¾ã¨ã‚.

tags: [ğŸ·Clojure]({{< relref "20211111225741.md" >}}) [ğŸ·Web Development]({{< relref "20220220094636.md" >}})

ãƒ†ãƒ¼ãƒãŒå¤§ãã„ã®ã§åˆ†å‰²ã™ã‚‹ã‹ã‚‚.

-   API Server ã¯ã“ã¡ã‚‰: [ğŸ“Clojure API Server Development]({{< relref "20220226220442.md" >}})
-   API Client ã¯ã“ã¡ã‚‰: [ğŸ“Clojure API Client Development]({{< relref "20220209102028.md" >}})


## Clojure Web Developmentæ¦‚è«– {#clojure-web-developmentæ¦‚è«–}

Clojureã§ã¯Railsã‚„Djangoã®ã‚ˆã†ãªãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰ãª
Webãƒ•ãƒ¬ãƒ¼ãƒ ãƒ¯ãƒ¼ã‚¯ã‚’ã¤ã‹ã†ã‚ˆã‚Šã‚‚ å°ã•ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’çµ„ã¿åˆã‚ã›ã¦é–‹ç™ºã™ã‚‹ã“ã¨ãŒå¤šã„.

ãã®ãŸã‚æ©Ÿèƒ½ã”ã¨ã«ã„ã‚ã‚“ãªãƒ©ã‚¤ãƒ–ãƒ©ãƒªãŒå­˜åœ¨ã™ã‚‹.


## Clojure: Web Frameworks {#clojure-web-frameworks}

-   Luminus
-   [Duct]({{< relref "20220211142329.md#clojure-backend-framework" >}}) (æ­£ç¢ºã«ã¯çŠ¶æ…‹ç®¡ç†ãƒ©ã‚¤ãƒ–ãƒ©ãƒª + ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«ä½œæˆãƒ†ãƒ³ãƒ—ãƒ¬ãƒ¼ãƒˆ).

ref: [ğŸ·Web Framework]({{< relref "20220220095102.md#web-application-framework" >}})


## Clojure: Ring - Webã‚µãƒ¼ãƒæŠ½è±¡ {#clojure-ring-webã‚µãƒ¼ãƒæŠ½è±¡}

<https://github.com/ring-clojure/ring>

Clojureã«ãŠã‘ã‚‹Web Server Abstructionã®ãƒ‡ãƒ•ã‚¡ã‚¯ãƒˆã‚¹ã‚¿ãƒ³ãƒ€ãƒ¼ãƒ‰.

-   [Why Use Ring? Â· ring-clojure/ring Wiki Â· GitHub](https://github.com/ring-clojure/ring/wiki/Why-Use-Ring%3F)
    -   ãªãœRingã‚’ã¤ã‹ã†ã®ã‹ï¼Ÿ
        -   Webã‚¢ãƒ—ãƒªã‚’Clojureã®é–¢æ•°ã¨Mapãƒ‡ãƒ¼ã‚¿ã®ã¿ã§æ§‹ç¯‰ã™ã‚‹ã¨ã„ã†è¨­è¨ˆæ¦‚å¿µã‚’ç¤ºã™.
        -   Java servletã®ä¸Šã§èµ°ã‚‹ã‚¢ãƒ—ãƒªã«ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã™ã‚‹.
-   4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã‹ã‚‰ãªã‚‹([ref](https://github.com/ring-clojure/ring/wiki/)).
    -   Handler
        -   Clojureã®é–¢æ•°ã§è¡¨ç¾ã•ã‚Œã‚‹.
        -   Request Mapã‚’å—å–ã‚Š, Response Mapã‚’è¿”ã™.
    -   Request
    -   Response
    -   Middleware

ref: [ğŸ·Web Server Abstruction]({{< relref "20220220095102.md#web-server-abstruction" >}}) [ğŸ“Clojure: Pedestal]({{< relref "20220226220442.md#clojure-pedestal" >}})


### ring: middleware {#ring-middleware}

ãŠå½¹ç«‹ã¡middlewareã‚’ã¾ã¨ã‚ã¦ã„ã.

-   [ring](https://github.com/ring-clojure/ring/tree/master/ring-core/src/ring/middleware)
    -   wrap-params(ring.middleware.params)
        -   ringã¯ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ã¯requestã«ä»˜éšã™ã‚‹ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«å¯¾ã—ã¦ãªã«ã‚‚ã—ãªã„.
            wrap-paramsã‚’åˆ©ç”¨ã™ã‚‹ã¨ ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã‚’å‡¦ç†ã—ã¦ãã‚Œã‚‹.
            -   (é€šå¸¸getã‹ã‚‰ã®) urlã«ã¤ã„ãŸquery-paramsã‚’ :query-paramsã«bind.
            -   (é€šå¸¸postã‹ã‚‰ã®) bodyã®ä¸­ã®form-paramsã‚’ :form-paramsã«bind.
            -   :query-paramsã¨ :form-paramsã®ãƒ‡ãƒ¼ã‚¿ã‚’ :paramsã«ãƒãƒ¼ã‚¸. ãã®ãŸã‚å¤§æŠµã¯
                :paramsã‚’ãƒã‚§ãƒƒã‚¯ã™ã‚Œã°ãƒ‡ãƒ¼ã‚¿ãŒå…¥ã£ã¦ã„ã‚‹.
    -   wrap-keyword-params(ring.middleware.keyword-params)
        -   ring ã¯ request-mapã®keyã‚’defaultã§ã¯stringã¨ã—ã¦æ‰±ã†.ã“ã‚Œã‚’keywordã«å¤‰æ›ã™ã‚‹.
        -   wrap-json-paramsã®:json-paramsã¯ ring parameter mapã§ã‚ã‚‹ :paramsã«ãƒãƒ¼ã‚¸ã•ã‚Œã‚‹. ã—ã‹ã—ring paramsã¯ mapã®keyãŒkeywordã§ã¯ãªãstringã¨ã—ã¦æ‰±ã†ãŸã‚ wrap-keyword-params ã¨ã®ä½µç”¨ãŒå¿…è¦.
-   [ring-json](https://github.com/ring-clojure/ring-json)(ring.middleware.json)
    -   wrap-json-response
        -   response-mapã®bodyã®Colojure Mapã‚„Vectorã‚’plain/textã®JSONã«å¤‰æ›.
    -   wrap-json-body
        -   request-mapã®bodyã®jsonå½¢å¼ã®æ–‡å­—åˆ—ã‚’clojure collectionã«å¤‰æ›ã—ã¦ :bodyã«binding.
    -   wrap-json-params
        -   request-mapã® bodyã® jsonå½¢å¼ã®æ–‡å­—åˆ—ã‚’ Mapã«å¤‰æ›ã—ã¦(:bodyã§ã¯ãªã)
            :json-paramsã«binding.


### tips: run-jettyã«handlerã®varã‚’æ¸¡ã—ã¦hot reloading {#tips-run-jettyã«handlerã®varã‚’æ¸¡ã—ã¦hot-reloading}

varã¯ ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­ **#'** ã«ã¦å–å¾—ã§ãã‚‹. ã™ãªã‚ã¡,

```clojure
(run-jetty #'handler {:port 3000})
```

è©³ã—ãã¯ä»¥ä¸‹ã‚’å‚ç…§.

-   [Column: REPL é§†å‹•é–‹ç™ºã‚’å–ã‚Šå…¥ã‚Œã¦ Ring ã§ã‚‚ã†å°‘ã—éŠã‚“ã§ã¿ã‚‹ â€” Clojure ã®æ—¥æœ¬èªã‚¬ã‚¤ãƒ‰](http://ayato-p.github.io/clojure-beginner/intro_web_development/column_rdd_and_more_ring.html)
-   [ä½•æ•…ã€Ringãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã«Varã‚’æ¸¡ã™ã¨ã€ãƒãƒ³ãƒ‰ãƒ©ãƒ¼ã‚’æ›¸ãæ›ãˆã¦ã‚‚æ›¸ãæ›ãˆãŸãƒãƒ³ãƒ‰ãƒ©ãƒ¼ãŒå‘¼ã³å‡ºã•ã‚Œã‚‹ã®ã‹ - ayato-p](https://scrapbox.io/ayato-p/%E4%BD%95%E6%95%85%E3%80%81Ring%E3%83%8F%E3%83%B3%E3%83%89%E3%83%A9%E3%83%BC%E3%81%ABVar%E3%82%92%E6%B8%A1%E3%81%99%E3%81%A8%E3%80%81%E3%83%8F%E3%83%B3%E3%83%89%E3%83%A9%E3%83%BC%E3%82%92%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88%E3%81%A6%E3%82%82%E6%9B%B8%E3%81%8D%E6%8F%9B%E3%81%88%E3%81%9F%E3%83%8F%E3%83%B3%E3%83%89%E3%83%A9%E3%83%BC%E3%81%8C%E5%91%BC%E3%81%B3%E5%87%BA%E3%81%95%E3%82%8C%E3%82%8B%E3%81%AE%E3%81%8B)

varã¨ã„ã†ã®ãŒå‚ç…§å‹ã®ãŸã‚å®Ÿéš›ã‚’å·®ã—æ›¿ãˆã‚‰ã‚Œã‚‹.

-   refs
    -   [Clojure: clojure.lang.Var]({{< relref "20220116080418.md#clojure-defã¨varã¨symbol" >}})
    -   [ğŸ’¡ def macro / alter-var-rootã«ã‚ˆã‚‹varã®å†å®šç¾©]({{< relref "20220116080418.md#clojure-defã¨varã¨symbol" >}})
    -   [Reloaded Workflow]({{< relref "20220117205249.md#reloaded-workflow" >}})


### References {#references}

-   [clojure-ring - é–‹ç™ºè€…ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://ja.getdocs.org/clojure-ring/)
-   [Part2: Ring ã«ã¤ã„ã¦çŸ¥ã‚‹ â€” Clojure ã®æ—¥æœ¬èªã‚¬ã‚¤ãƒ‰](https://ayato-p.github.io/clojure-beginner/intro_web_development/part2_what_is_ring.html)
    -   ã‚ã‚„ã¨ã´ã•ã‚“ã®Web é–‹ç™ºãƒãƒ¥ãƒ¼ãƒˆãƒªã‚¢ãƒ«.
-   [Clojureã®Webé–‹ç™ºã§ã‚‚ã£ã¨ã‚‚é‡è¦ãªRing Handlerã«ã¤ã„ã¦ç†è§£ã™ã‚‹ - TOYOKUMO](https://tech.toyokumo.co.jp/entry/2019/07/03/122656)
-   [Clojure Ring Middlewareå¤§å…¨ - TOYOKUMO Tech Blog](https://tech.toyokumo.co.jp/entry/2019/12/26/174006)
    -   ãƒˆãƒ¨ã‚¯ãƒ¢ã®æ–°å’ã‚„ã‚¢ãƒ«ãƒã‚¤ãƒˆå­¦ç”Ÿã®ãŸã‚ã®æ•™è‚²ç”¨Ringè§£èª¬è¨˜äº‹.


### Active Recalls {#active-recalls}


#### Clojure Ringã®ã‚ˆã†ãªWebã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã‚’ä¸€èˆ¬çš„ã«ãªã‚“ã¨ã„ã„ã¾ã™ã‹ï¼Ÿ {#clojure-ringã®ã‚ˆã†ãªwebã‚¢ãƒ—ãƒªã‚’æ§‹ç¯‰ã™ã‚‹ãŸã‚ã®ä»•çµ„ã¿ã‚’ä¸€èˆ¬çš„ã«ãªã‚“ã¨ã„ã„ã¾ã™ã‹}

Webã‚µãƒ¼ãƒæŠ½è±¡, Web Server Abstruction.

Web Serverã¨ Web ã‚¢ãƒ—ãƒªãŒã‚„ã‚Šå–ã‚Šã‚’ã™ã‚‹ãŸã‚ã®ä»•æ§˜.


#### Clojure Ring ã«ãŠã‘ã‚‹4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojure-ring-ã«ãŠã‘ã‚‹4ã¤ã®ã‚³ãƒ³ãƒãƒ¼ãƒãƒ³ãƒˆã¯ãªã‚“ã§ã™ã‹}

ãƒãƒ³ãƒ‰ãƒ©ãƒ¼, ãƒŸãƒ‰ãƒ«ã‚¦ã‚§ã‚¢, ãƒªã‚¯ã‚¨ã‚¹ãƒˆãƒãƒƒãƒ—, ãƒ¬ã‚¹ãƒãƒ³ã‚¹ãƒãƒƒãƒ—.


## Heroku with Clojure {#heroku-with-clojure}

-   <https://devcenter.heroku.com/articles/deploying-clojure>
    -   ja: <https://devcenter.heroku.com/ja/articles/deploying-clojure>
-   <https://devcenter.heroku.com/articles/getting-started-with-clojure>
    -   ja: <https://devcenter.heroku.com/ja/articles/getting-started-with-clojure>
-   <https://devcenter.heroku.com/articles/clojure-support>
    -   ja: <https://devcenter.heroku.com/ja/articles/clojure-support>

leiningenã®ä½œè€…ãŒHerokuã§åƒã„ã¦ãŸã‚‰ã—ããƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãŒã¦ã„ã­ã„ã¨ã‹.

<https://twitter.com/as_chapa/status/1198104444711256064>
<https://twitter.com/iku000888/status/1099293410693808128>


### tip: Herokuä¸Šã®appã«replã§æ¥ç¶š {#tip-herokuä¸Šã®appã«replã§æ¥ç¶š}

heroku run lein replã§Herokuã‚µãƒ¼ãƒä¸Šã§replã‚’èµ·å‹•ã§ãã‚‹.

&gt; heroku run lein repl


### howto: Heroku Deployã§lein depså¤±æ•—ã®å¯¾å‡¦æ–¹æ³• {#howto-heroku-deployã§lein-depså¤±æ•—ã®å¯¾å‡¦æ–¹æ³•}

&gt; Leiningen 1.7.1 ãŒãƒ‡ãƒ•ã‚©ãƒ«ãƒˆã§ä½¿ç”¨ã•ã‚Œã¾ã™ãŒã€project.clj ã« :min-lein-version
"2.0.0"â€‹ ãŒã‚ã‚‹å ´åˆã¯ (å¼·ãæ¨å¥¨ã•ã‚Œã¾ã™)ã€Leiningen 2.9.1 ãƒªãƒªãƒ¼ã‚¹ãŒä»£ã‚ã‚Šã«ä½¿ç”¨ã•ã‚Œã¾ã™ã€‚

ã“ã‚Œã«ãƒãƒã£ãŸ. project.cljã« :min-lein-version "2.0.0" ã‚’è¨˜è¼‰ã—ã¦è§£æ±ºâœ¨

ref: <https://devcenter.heroku.com/ja/articles/clojure-support>


### howto: Herokuä¸Šã§ Botã‚’å‹•ã‹ãã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼ {#howto-herokuä¸Šã§-botã‚’å‹•ã‹ãã†ã¨ã™ã‚‹ã¨ã‚¨ãƒ©ãƒ¼}

web appã§ã¯ãªã worker appã«ã™ã‚‹å¿…è¦ãŒã‚ã‚‹.

ãã†ã—ãªã„ã¨ 60secã§BootTimeoutã¨ã—ã¦æ‰±ã‚ã‚Œã¦Process Killã•ã‚Œã‚‹.

```text
2022-02-11T09:30:12.486217+00:00 heroku[web.1]: Error R10 (Boot timeout) -> Web process failed to bind to $PORT within 60 seconds of launch
2022-02-11T09:30:12.581863+00:00 heroku[web.1]: Stopping process with SIGKILL
2022-02-11T09:30:12.834345+00:00 heroku[web.1]: Process exited with status 137
2022-02-11T09:30:13.225734+00:00 heroku[web.1]: State changed from starting to crashed
```

Procfileã‚’æ–°è¦ä½œæˆã—ã¦ä»¥ä¸‹ã‚’è¨˜è¼‰.

&gt; worker: lein run

heroku cliã‚ˆã‚Š

&gt; heroku ps:scale worker=1

ãŸã ã— workerã¯30åˆ†æ´»å‹•ãŒãªã„ã¨sleepã—ã¦ã—ã¾ã†.

å®Ÿéš›ã¯heroku schedulerã®æ´»ç”¨ã‚‚æ¤œè¨.


### howto: tools.depsç®¡ç†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’Herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤ {#howto-tools-dot-depsç®¡ç†ã®ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’herokuã«ãƒ‡ãƒ—ãƒ­ã‚¤}

æœªå®Ÿæ–½ã ã‘ã©ãƒ–ãƒƒã‚¯ãƒãƒ¼ã‚¯. leiningenã®ä½œè€…ã¯ãƒ©ã‚¤ãƒãƒ«ã«ã„ã˜ã‚ã‚‹ï¼Ÿ

ref: [è©¦è¡ŒéŒ¯èª¤ãªæ—¥ã€…: clojure cliãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’herokuã§å‹•ã‹ã™](https://asukiaaa.blogspot.com/2022/03/clojure-cli-on-heroku.html)


## Firebase/Google Cloud w/ Clojure {#firebase-google-cloud-w-clojure}

[ğŸ·Firebase]({{< relref "20220215183442.md" >}})

ref: <https://github.com/tsu-nera/meigen-bot-firebase-clj>


## Firebase Firestore(aka. Google Cloud Firestore)  w/ Clojure {#firebase-firestore--aka-dot-google-cloud-firestore--w-clojure}

ã›ã£ã‹ãã®Clojureãªã®ã§Clojure onlyã§é ‘å¼µã‚‰ãšã«Javaã‚„node.jsã®è³‡ç”£ã‚’æ´»ç”¨ã™ã‚‹æ–¹å‘ãŒã„ã„ã‹ãª...Javaè³‡ç”£æ´»ç”¨ã—ãªã„ã¨ãƒªãƒƒãƒãƒ¼ãƒ’ãƒƒã‚­ãƒ¼ã®é–‹ç™ºãƒ¢ãƒãƒ™ã«åã™ã‚‹ğŸ¤”

-   [Add the Firebase Admin SDK to your server Â |Â  Firebase Documentation](https://firebase.google.com/docs/admin/setup/)
-   [Get started with Cloud Firestore Â |Â  Firebase Documentation](https://firebase.google.com/docs/firestore/quickstart)


### ğŸ’¡Firestoreã®ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹ã®ãƒ¡ãƒªãƒƒãƒˆã¨clojure.specã®æ€æƒ³ãŒåã™ã‚‹ {#firestoreã®ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹ã®ãƒ¡ãƒªãƒƒãƒˆã¨clojure-dot-specã®æ€æƒ³ãŒåã™ã‚‹}

Firestoreã¯[ã‚¹ã‚­ãƒ¼ãƒãƒ¬ã‚¹DB]({{< relref "20220311163333.md#nosqlã®ç‰¹å¾´" >}})ã¨ã„ã†ã“ã¨ã‚’ç•™æ„ã™ã‚‹.

ã™ãªã‚ã¡ã“ã®ç‰¹æ€§ã«ã‚ˆã‚Šã‚¹ã‚­ãƒ¼ãƒè¨­è¨ˆãŒä¸è¦ã¨ã„ã†ãƒ¡ãƒªãƒƒãƒˆã‚’æ´»ã‹ã™ãªã‚‰ã°å‹•çš„è¨€èªã§ã‚ã‚‹Clojureã¨ã® ç›¸æ€§ãŒã‚ˆã
JSON Schema(Shcema/Malli/clojure.spce)ã¯ä¸è¦ã‹ã‚‚ã—ã‚Œãªã„.

ref. [ğŸ“Clojure spec]({{< relref "20220323030746.md" >}})


### ğŸ’¡Firestoreã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã¨Clojureãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®æ€æƒ³ãŒåã™ã‚‹ {#firestoreã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã¨clojureãƒ—ãƒ­ãƒˆã‚³ãƒ«ã®æ€æƒ³ãŒåã™ã‚‹}

ã¾ãŸFirestoreã¯ [ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹]({{< relref "20220311163333.md#ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹" >}})ã¨ã„ã†ã“ã¨ã‚‚æ³¨æ„.

ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã®ãƒ¢ãƒ‡ãƒ«ã‚’ä½œæˆã—ã¦ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã‚’å®šç¾©ã™ã‚‹å¿…è¦ã¯ã‚ã‚‹ã®ã‹ï¼Ÿ

ãªãœãªã‚‰ã°ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã¯ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«æ ¼ç´ã•ã‚Œã¦ãã®ç¯„å›²å†…ã§ã®ã¿ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å‡¦ç†ã•ã‚Œã‚‹. ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã¨ã¯æ“ä½œæŠ½è±¡ã§ã‚ã‚Šç•°ãªã‚‹ãƒ‡ãƒ¼ã‚¿å‹ã‚’åŒä¸€IFã§ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ã«å‡¦ç†ã™ã‚‹ã“ã¨ãŒç›®çš„ã§ã‚ã‚‹ãŒãã‚‚ãã‚‚ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹ã®ãƒ‘ãƒ©ãƒ€ã‚¤ãƒ ã«ãŠã„ã¦ã¯ç•°ãªã‚‹ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’åŒä¸€ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«å…¥ã‚Œã‚‹ã®ã‹ã¨ã„ã†å•é¡ŒãŒã‚ã‚‹.

ref: [ğŸ“Firebase Firestore]({{< relref "20220311153829.md" >}}) [defprotocol]({{< relref "20220307162746.md#ãƒ—ãƒ­ãƒˆã‚³ãƒ«--protocols" >}})


## Firebase Functions(aka. Google Cloud Functions) w/ Clojure {#firebase-functions--aka-dot-google-cloud-functions--w-clojure}

ClojureScriptã‚’åˆ©ç”¨ã—ã¦JavaScript(Node.js)ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä½¿ã†ã®ãŒã‚ˆã„.

-   [ClojureScript + Firebase - DEV Community](https://dev.to/kbaba1001/clojurescript-firebase-3a26)
    -   ref: <https://twitter.com/kbaba1001/status/1342628846655324160>
-   [My PWA made with Clojure/ClojureScript exceeded 400 users ğŸ‰ - DEV Community](https://dev.to/boxp/my-pwa-made-with-clojure-clojurescript-exceeded-400-users-5co7)
    -   ref: <https://twitter.com/b0xp2/status/1259685025122930689>

ã—ã‹ã—Clojureã®é“ã«æŒ‘æˆ¦ã—ã¦ã—ã¾ã£ãŸ...åœ°é›·ã ã‚‰ã‘.

åŸºæœ¬æ–¹é‡ã¨ã—ã¦ã¯, Google Cluud Functionsã®Java11ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã®ãƒšãƒ¼ã‚¸ã‚’ã¿ãªãŒã‚‰,
functions-framework-java ã‚’åˆ©ç”¨ã™ã‚‹.

-   <https://cloud.google.com/functions/docs/concepts/java-runtime>
-   <https://github.com/GoogleCloudPlatform/functions-framework-java>

2022.01æ™‚ç‚¹ã§ã®æ³¨æ„ç‚¹ã¨ã—ã¦ã¯,

-   ä»–ã®JVMè¨€èªã®ã¨ã“ã‚ã«ClojureãŒç™»å ´ã—ãªã„.
    -   <https://cloud.google.com/functions/docs/concepts/jvm-langs>
    -   Scala, Kotlin, Groovyã¯ç™»å ´ã™ã‚‹.
    -   ä»–ã®JVMè¨€èªã‚’çœŸä¼¼ã—ã¦Clojureã‚’å®Ÿè¡Œã—ã‚ˆã†ã¨ã™ã‚‹ã¨,ã‚¨ãƒ©ãƒ¼.
-   ãƒ‡ãƒ—ãƒ­ã‚¤æ–¹å¼ã¯ï¼’ã¤ã‚ã‚‹ãŒãŠãã‚‰ããƒ­ãƒ¼ã‚«ãƒ«ãƒ“ãƒ«ãƒ‰ã§ãªã„ã¨å¤±æ•—.
    -   <https://cloud.google.com/functions/docs/concepts/java-deploy>
    -   ã‚½ãƒ¼ã‚¹ã‹ã‚‰ã®ãƒ‡ãƒ—ãƒ­ã‚¤ã¯pom.xmlã¨ã‚½ãƒ¼ã‚¹ã®uploadã¯æˆåŠŸã™ã‚‹ãŒclojureã®ãƒ“ãƒ«ãƒ‰ã§ã‚³ã‚±ã‚‹. ãã‚‚ãã‚‚Cloud Functionsã§ä½¿ã‚ã‚Œã¦ã„ã‚‹Cloud Bulildã§Clojureã®ãƒ“ãƒ«ãƒ‰ã«å¯¾å¿œã—ã¦ã„ã‚‹ã®ã‹æ€ªã—ã„. ClojureCoreãã®ä»–ã¯ã¯defaultã§Java8ã§ãƒ“ãƒ«ãƒ‰ã•ã‚Œã¦ã„ã‚‹.
        ä¸€æ–¹Cloud Functionsã®ãƒ©ãƒ³ã‚¿ã‚¤ãƒ ã¯11.
    -   ã—ãŸãŒã£ã¦uberjar(fatjar)ã‚’ãƒ­ãƒ¼ã‚«ãƒ«ã§ä½œæˆã—ã¦.classãƒ•ã‚¡ã‚¤ãƒ«ã¨ä¸€ç·’ã«uploadã™ã‚‹ã®ãŒã„ã„.
-   ä»¥ä¸‹ã®3ã¤ã®ãƒªãƒã‚¸ãƒˆãƒªãŒå‚è€ƒã«ãªã‚‹.
    -   <https://github.com/pepijn/google-cloud-functions-clojure>
    -   <https://pathom3.wsscode.com/docs/tutorials/serverless-pathom-gcf/#gcf-deploy>
    -   <https://github.com/atomist-skills/gcf-java11-clojure>
-   ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆã¯ã‚¨ãƒ³ãƒˆãƒªãƒã‚¤ãƒ³ãƒˆã‚’Javaã§ç”¨æ„ã™ã‚‹ã¨ã“ã‚.
    -   Clojureã§ç”¨æ„ã—ã‚ˆã†ã¨ã—ã¦ã‚‚ãƒ“ãƒ«ãƒ‰ã‚¨ãƒ©ãƒ¼ã™ã‚‹.
-   ruberjarã®ãƒ“ãƒ«ãƒ‰ã«ã¯ã® [ğŸ“tools.build]({{< relref "20220119063524.md#clojure-cli-tools-dot-deps-clojure-build-tool" >}}) ã®guideã‚’ã¿ã¦,
    Javaã‚½ãƒ¼ã‚¹ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã—ã¦Clojureã‚³ãƒ¼ãƒ‰ã‚’uberjarã§.jarãƒ•ã‚¡ã‚¤ãƒ«ã«å«ã‚ã‚‹.


## ğŸ“Google Cloud Run w/ Clojure {#google-cloud-run-w-clojure}

[ğŸ·Jib]({{< relref "20220316081935.md#jib-build-container-images-for-your-java-applications" >}}) ã‚’åˆ©ç”¨ã—ã¦ã‚³ãƒ³ãƒ†ãƒŠãƒ“ãƒ«ãƒ‰ã™ã‚‹.

-   [Clojure in Google Cloud Run with Jib â€“Â Hannu Hartikainen](https://hannuhartikainen.fi/blog/clojure-cloud-run/)
-   [Clojure app on Google Cloud Run | 3sky's notes](https://blog.3sky.dev/article/google-run-clojure/)
-   [Google Cloud Run ã§ Clojure ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã‚’å®Ÿè¡Œã—ã‚ˆã† | Micheam's TechBlog](https://blog.micheam.com/2019/12/12/how-to-run-clojure-on-google-cloud-run/)

å®Ÿéš›ã«æ¤œè¨¼ã—ãŸæ„Ÿè§¦ã§ã¯Cloud Functionsã‚ˆã‚Šã‚‚åœ§å€’çš„ã«æ¥½.

ref: <https://github.com/tsu-nera/meigen-bot-gcloud-run-clj>

æœ€è¿‘, [jibbit](https://github.com/atomisthq/jibbit) ã¨ã„ã†clojureã‹ã‚‰jibã‚’æ‰±ã„ã‚„ã™ã—ãŸãƒ„ãƒ¼ãƒ«ã‚‚ç™»å ´(2022/01).

-   <https://twitter.com/kipzter/status/1480982692036591620>
-   [Containerizing a Clojure Project | Atomist Blog](https://blog.atomist.com/containerizing-a-clojure-project/)


## References {#references}

-   ğŸ”—[ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã¨ã¯ã¾ã£ãŸãé•ã†Clojureã®ä¸–ç•Œã¨å®Ÿéš›ã®Webé–‹ç™º - ç´™ç®±](https://boxofpapers.hatenablog.com/entry/2018/06/24/160802)
-   ğŸ”—[Clojure ã§ Web é–‹ç™ºã‚’ã¯ã˜ã‚ã¦ã¿ã‚ˆã† â€” Clojure ã®æ—¥æœ¬èªã‚¬ã‚¤ãƒ‰](http://ayato-p.github.io/clojure-beginner/intro_web_development/index.html)
-   <http://ayato-p.github.io/clojure-beginner/intro_web_development/index.html>
    -   ayato-pã•ã‚“ã®ä½œ.
        -   ãŸã—ã‹ã‚ãŸã—ãŒClojureã«ã¯ã˜ã‚ã¦è§¦ã‚ŒãŸ2015ã”ã‚ã«ã¯ã™ã§ã«ã‚ã£ãŸæ°—ãŒã™ã‚‹.
-   [Web Development with Clojure (ç¬¬3ç‰ˆ) ã®ç´¹ä»‹ - Qiita](https://qiita.com/t-cool/items/59c52d6e80beca2fdee8)
