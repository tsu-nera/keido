+++
title = "ğŸ“Clojure Async"
tags = ["WIKI"]
draft = false
+++

up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})


## Clojure core.async {#ef9fef}

éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã†ã¾ãè¡Œã†.

<https://github.com/clojure/core.async>

ã‚ãŸã—ã®æ‹™ã„è¨˜æ†¶ã ã¨, éåŒæœŸå‡¦ç†ã‚’Java ã‚„Pythonã§ã†ã¾ãå‡¦ç†ã™ã‚‹ã«ã¯ï¼ŒåŒæœŸã‚­ãƒ¥ãƒ¼ã‚’ç”¨ã„ãŸproducer-consumer patternã‚’ã¤ã‹ã†ã®ãŒé‰„æ¿ã ãŒï¼Œãã‚Œã‚’core.asyncã‚’ã¤ã‹ã†ã“ã¨ã«ã‚ˆã£ã¦ã‹ã‚“ãŸã‚“ã«å®Ÿè£…ã§ãã‚‹(ç´ æ™´ã‚‰ã—ã„).

ä¸€å¿œéå»è¨˜äº‹ã‚’ã¿ã‚‹ã¨ï¼Œå…±æœ‰ãƒ¡ãƒ¢ãƒªæ–¹å¼ã§ã¯ãªãï¼Œæ±ºå®šæ€§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ¢ãƒ‡ãƒ«??(å¿˜ã‚ŒãŸ).

-   refs
    -   [ğŸ–ŠJava ã§ Producer-Consumer Pattern ã‚’å®Ÿè£…ã—ã¦ã¿ãŸ | Futurismo](https://futurismo.biz/archives/2656/)
    -   [ğŸ–Šãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å¤‰æ•° (Oz) ã§å®Ÿç¾ã™ã‚‹ Producer-Consumer Pattern | Futurismo](https://futurismo.biz/archives/2829/)


## Clojure: atom/delay/future/promiseã®æ¯”è¼ƒ {#0cd352b6-a062-445a-bb00-dce7714f76ed}

ã„ãšã‚Œã‚‚åŒã˜é–¢æ•°deref/@(reader macro)ã§èª­ã¿å‡ºã›ã‚‹ã¨ã“ã‚ãŒã‚„ã‚„ã“ã—ã„.

-   atom: ãƒ¡ãƒ¢ãƒªå…±æœ‰
    -   ã‚¹ãƒ¬ãƒƒãƒ‰å†…ã®ãƒ¡ãƒ¢ãƒªå…±æœ‰ã®ä»•çµ„ã¿ã‚ã‚ŠçŠ¶æ…‹ã‚’æ‰±ã†.
-   delay: é…å»¶è©•ä¾¡
    -   **force or deref or @** ã‚’ã¤ã‹ã£ã¦è©•ä¾¡ã—ã¦ã¯ã˜ã‚ã¦è¨ˆç®—ãŒã¯ã˜ã¾ã‚‹.
-   future: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ
    -   è©•ä¾¡ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰(i.e.åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰)ã§å§‹ã¾ã‚‹ãŒ,
        ãã®çµæœã¯å‚ç…§ã—ã¦ã¯ã˜ã‚ã¦ã‚ã‹ã‚‹
        (or ã¾ã è¨ˆç®—ãŒçµ‚ã‚ã£ã¦ãªã„ã‹ã‚‚ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‹ã‚‹).
-   promise: ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œ + é…å»¶è©•ä¾¡.
    -   promiseã¯futureã«ä¼¼ã¦ã„ã‚‹. ã©ã¡ã‚‰ã‚‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œã«å¯¾ã™ã‚‹å‚ç…§ã‚’è¿”ã™.
        -   futureã¯å®£è¨€æ™‚ã«ãƒ—ãƒ­ã‚·ãƒ¼ã‚¸ãƒ£ã‚‚å®£è¨€ã—ã¦å³æ™‚å®Ÿè¡Œ.
        -   promiseã¯å®£è¨€æ™‚ã¯å‚ç…§ã«éããšdeleverã§å‡¦ç†ã‚’ã‚ã¨ã‹ã‚‰bindingã™ã‚‹.
    -   promiseã¯å€¤, futureã¯é–¢æ•°å€¤ã®ã‚ˆã†ãªã‚¤ãƒ¡ãƒ¼ã‚¸.
        -   ã©ã¡ã‚‰ã‚‚ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰å®Ÿè¡Œã®ãŸã‚derefã§çµæœã‚’å‚ç…§ã§ãã‚‹.

---

-   refs
    -   [clojure future vs delay - Stack Overflow](https://stackoverflow.com/questions/28985818/clojure-future-vs-delay)
    -   [terminology - How do Clojure futures and promises differ? - Stack Overflow](https://stackoverflow.com/questions/4623536/how-do-clojure-futures-and-promises-differ)
    -   [Cuddly, Octo-Palm Tree: The Clojure Promise](https://cuddly-octo-palm-tree.com/posts/2021-11-14-clojure-promise/)


## Refenreces {#2f08fb}

-   ğŸ”—[Clojure + core.async ã«ã‚ˆã‚‹éåŒæœŸï¼†ä¸¦åˆ—ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸–ç•Œ - ç´™ç®±](https://boxofpapers.hatenablog.com/entry/core_async)


## Active Recalls {#b27a23}


### clojure.coreã® delayã¨futureé•ã„ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#b2d745}

delayã¯é…å»¶è©•ä¾¡, futureã¯åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰è©•ä¾¡.


### Clojure core.asyncã®ãƒãƒ£ãƒãƒ«ã®å®£è¨€ã®ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#b4a737}

async/chan

ex. (def tea-channel (async/chan 10))


### Clojure core.asyncã®channelã«åŒæœŸçš„ã«å€¤ã‚’å–ã‚Šå‡ºã™ã¨ãã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹? {#835407}

/>!!


### Clojure core.asyncã®channelã«éåŒæœŸã«put(or get)ã™ã‚‹ã¨ãã® ! ã®æ•°ã¯? {#201f0b}

1ã¤.


### Clojure core.asyncã«ãŠã„ã¦å€¤ãŒãƒãƒ£ãƒãƒ«ã«å…¥ã£ã¦ãã‚‹ã®ã‚’ãƒœãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ãƒ–ãƒ­ãƒƒã‚¯ã®è¨˜æ³•ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#6af37a}

async/go-loop  ã¨ recur

ex.

(def tea-channel (async/chan 10))
(async/go-loop []
                   (println "hi from " (async/<! tea-channel))
                   (recur))
