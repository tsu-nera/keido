+++
title = "ğŸ“Clojure Async"
tags = ["WIKI"]
draft = false
+++

up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})

Clojure core.asyncã«ã¤ã„ã¦. éåŒæœŸãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã‚’ã†ã¾ãè¡Œã†.

<https://github.com/clojure/core.async>

ã‚ãŸã—ã®æ‹™ã„è¨˜æ†¶ã ã¨, éåŒæœŸå‡¦ç†ã‚’Java ã‚„Pythonã§ã†ã¾ãå‡¦ç†ã™ã‚‹ã«ã¯ï¼ŒåŒæœŸã‚­ãƒ¥ãƒ¼ã‚’ç”¨ã„ãŸproducer-consumer patternã‚’ã¤ã‹ã†ã®ãŒé‰„æ¿ã ãŒï¼Œãã‚Œã‚’core.asyncã‚’ã¤ã‹ã†ã“ã¨ã«ã‚ˆã£ã¦ã‹ã‚“ãŸã‚“ã«å®Ÿè£…ã§ãã‚‹(ç´ æ™´ã‚‰ã—ã„).

ä¸€å¿œéå»è¨˜äº‹ã‚’ã¿ã‚‹ã¨ï¼Œå…±æœ‰ãƒ¡ãƒ¢ãƒªæ–¹å¼ã§ã¯ãªãï¼Œæ±ºå®šæ€§ãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼ãƒ¢ãƒ‡ãƒ«??(å¿˜ã‚ŒãŸ).

-   refs
    -   [ğŸ–ŠJava ã§ Producer-Consumer Pattern ã‚’å®Ÿè£…ã—ã¦ã¿ãŸ | Futurismo](https://futurismo.biz/archives/2656/)
    -   [ğŸ–Šãƒ‡ãƒ¼ã‚¿ãƒ•ãƒ­ãƒ¼å¤‰æ•° (Oz) ã§å®Ÿç¾ã™ã‚‹ Producer-Consumer Pattern | Futurismo](https://futurismo.biz/archives/2829/)


## Clojure: delay, future, promiseã®é•ã„ {#clojure-delay-future-promiseã®é•ã„}

ã„ãšã‚Œã‚‚åŒã˜é–¢æ•°deref, ã¾ãŸã¯ãƒªãƒ¼ãƒ€ãƒã‚¯ãƒ­@ã§èª­ã¿å‡ºã›ã‚‹ã¨ã“ã‚ãŒã‚„ã‚„ã“ã—ã„.

ã¾ãš3ã¤ã¯typeã§èª¿ã¹ã‚‹ã¨ãã‚Œãã‚Œå‹ãŒé•ã†.

delayã¯é…å»¶è©•ä¾¡ã§ã‚ã‚Š, force or deref or @ ã‚’ã¤ã‹ã£ã¦è©•ä¾¡ã—ã¦ã¯ã˜ã‚ã¦è¨ˆç®—ãŒã¯ã˜ã¾ã‚‹.

ä¸€æ–¹, futureã¯ é…å»¶è©•ä¾¡ã§ã¯ãªã„. è©•ä¾¡ã¯ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰(i.e.åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰)ã§å§‹ã¾ã‚‹ãŒãã®çµæœã¯å‚ç…§ã—ã¦ã¯ã˜ã‚ã¦ã‚ã‹ã‚‹(or ã¾ã è¨ˆç®—ãŒçµ‚ã‚ã£ã¦ãªã„ã‹ã‚‚ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‹ã‚‹)

ref: [clojure future vs delay - Stack Overflow](https://stackoverflow.com/questions/28985818/clojure-future-vs-delay)

promiseã¯ futureã®ä»²é–“ã ãŒã‚„ã‚„ã“ã—ã„ã®ã§å¾Œã§èª¿ã¹ã‚‹.

ref :[terminology - How do Clojure futures and promises differ? - Stack Overflow](https://stackoverflow.com/questions/4623536/how-do-clojure-futures-and-promises-differ)


## Refenreces {#refenreces}

-   ğŸ”—[Clojure + core.async ã«ã‚ˆã‚‹éåŒæœŸï¼†ä¸¦åˆ—ãƒ—ãƒ­ã‚»ã‚¹ã®ä¸–ç•Œ - ç´™ç®±](https://boxofpapers.hatenablog.com/entry/core_async)


## Active Recalls {#active-recalls}


### clojure.coreã® delayã¨futureé•ã„ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojure-dot-coreã®-delayã¨futureé•ã„ã¯ãªã‚“ã§ã™ã‹}

delayã¯é…å»¶è©•ä¾¡, futureã¯åˆ¥ã‚¹ãƒ¬ãƒƒãƒ‰ã§ã®ãƒãƒƒã‚¯ã‚°ãƒ©ã‚¦ãƒ³ãƒ‰è©•ä¾¡.


### Clojure core.asyncã®ãƒãƒ£ãƒãƒ«ã®å®£è¨€ã®ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojure-core-dot-asyncã®ãƒãƒ£ãƒãƒ«ã®å®£è¨€ã®ãŸã‚ã®ãƒ¡ã‚½ãƒƒãƒ‰ã¯ãªã‚“ã§ã™ã‹}

async/chan

ex. (def tea-channel (async/chan 10))


### Clojure core.asyncã®channelã«åŒæœŸçš„ã«å€¤ã‚’å–ã‚Šå‡ºã™ã¨ãã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹? {#clojure-core-dot-asyncã®channelã«åŒæœŸçš„ã«å€¤ã‚’å–ã‚Šå‡ºã™ã¨ãã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹}

/&gt;!!


### Clojure core.asyncã®channelã«éåŒæœŸã«put(or get)ã™ã‚‹ã¨ãã® ! ã®æ•°ã¯? {#clojure-core-dot-asyncã®channelã«éåŒæœŸã«put--or-get--ã™ã‚‹ã¨ãã®-ã®æ•°ã¯}

1ã¤.


### Clojure core.asyncã«ãŠã„ã¦å€¤ãŒãƒãƒ£ãƒãƒ«ã«å…¥ã£ã¦ãã‚‹ã®ã‚’ãƒœãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ãƒ–ãƒ­ãƒƒã‚¯ã®è¨˜æ³•ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojure-core-dot-asyncã«ãŠã„ã¦å€¤ãŒãƒãƒ£ãƒãƒ«ã«å…¥ã£ã¦ãã‚‹ã®ã‚’ãƒœãƒ¼ãƒªãƒ³ã‚°ã™ã‚‹ãŸã‚ã®ãƒ–ãƒ­ãƒƒã‚¯ã®è¨˜æ³•ã¯ãªã‚“ã§ã™ã‹}

async/go-loop  ã¨ recur

ex.

(def tea-channel (async/chan 10))
(async/go-loop []
                   (println "hi from " (async/&lt;! tea-channel))
                   (recur))
