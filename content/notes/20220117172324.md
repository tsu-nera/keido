+++
title = "ğŸ“Clojure Java Interop"
tags = ["WIKI"]
draft = false
+++

up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}}) refs: [ğŸ·Java]({{< relref "20220303203801.md" >}})

Clojureã¨Javaã®ã‚„ã‚Šã¨ã‚Šã‚’ã¾ã¨ã‚.


## Clojureã‹ã‚‰Javaã‚’å‘¼ã³å‡ºã— {#clojureã‹ã‚‰javaã‚’å‘¼ã³å‡ºã—}

-   ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶ã«ã¯, ãƒ¡ã‚½ãƒƒãƒ‰åã®å‰ã« **.** ã‚’æ›¸ã.
-   ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã«ã¯, ã‚¯ãƒ©ã‚¹åã®ã‚ã¨ã« **.** ã‚’æ›¸ã.


## Clojure-Java HashMap Interop {#clojure-java-hashmap-interop}


### howto: Clojure - Javaã®Hashmapã®å¤‰æ› {#howto-clojure-javaã®hashmapã®å¤‰æ›}

```clojure
(def java-map (java.util.HashMap. test-data))
(def clj-map  (into {} java-map))
```


### howto: Clojureã®keywordã‚’ stringã«ã™ã‚‹ã«ã¯ï¼Ÿ {#howto-clojureã®keywordã‚’-stringã«ã™ã‚‹ã«ã¯}

clojure.walkãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ãˆã‚‹. <https://clojuredocs.org/clojure.walk>

-   strinify-keys: keywords to string
-   keywordize-keys: string to keywords


## Clojure-Java Class {#clojure-java-class}


### howto: Javaã®classã‚’ç”Ÿæˆã™ã‚‹ã«ã¯? {#howto-javaã®classã‚’ç”Ÿæˆã™ã‚‹ã«ã¯}

ref: <https://clojure.org/reference/compilation>

namespaceã« (:gen-class)ã‚’è¨˜è¿°ã™ã‚‹.
namespaceã‚’æŒã¤ .classãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹.

default(AOT compile?) ã§ã¯ compileã™ã‚‹ã¨ãƒãƒ©ãƒãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œ, .classãŒãªã„.

```text
drwxr-xr-x 3 tsu-nera tsu-nera 4.0K  2æœˆ 16 13:40  ClojureHelloWorld
-rw-r--r-- 1 tsu-nera tsu-nera 1.4K  2æœˆ 16 13:40 'ClojureHelloWorld$fn__273.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.1K  2æœˆ 16 13:40 'ClojureHelloWorld$fn__275$fn__276.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.3K  2æœˆ 16 13:40 'ClojureHelloWorld$fn__275.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.9K  2æœˆ 16 13:40 'ClojureHelloWorld$loading__6737__auto____271.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.1K  2æœˆ 16 13:40  ClojureHelloWorld.clj
-rw-r--r-- 1 tsu-nera tsu-nera 2.4K  2æœˆ 16 13:40  ClojureHelloWorld__init.class
```


### howto: Javaã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’Clojureã§ç¶™æ‰¿ã™ã‚‹ã«ã¯ï¼Ÿ {#howto-javaã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’clojureã§ç¶™æ‰¿ã™ã‚‹ã«ã¯}

**proxy** ãƒã‚¯ãƒ­ã‚’ã¤ã‹ã†.
ã“ã‚Œã¯Javaã®ã‚¯ãƒ©ã‚¹ã‚’å¼•æ•°ã«ã—ã¦ç„¡åã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚’è¿”ã™ã®ã§é©å½“ãªå€¤ã«bindã™ã‚‹.

ref: <https://clojure.org/reference/java_interop#_implementing_interfaces_and_extending_classes>


## Clojure: å‹ãƒ’ãƒ³ãƒˆ(Type Hinting) {#clojure-å‹ãƒ’ãƒ³ãƒˆ--type-hinting}

[Clojure - Java Interop](https://clojure.org/reference/java_interop#typehints)

Clojureã¯å‹•çš„å‹ä»˜ã‘è¨€èªã ãŒå‹•çš„å‹ä»˜ã‘è¨€èªã®Javaã®ä¸Šã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚,
æš—é»™çš„ãªå‹ã¯ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦å‹æ¨è«–ã•ã‚Œã¦ã„ã‚‹.

ãã®ãŸã‚å‹hintã‚’è¨­å®šã™ã‚‹ã“ã¨ã§å‹æ¨è«–ã®åŠ¹ç‡åŒ–ã‚’ã™ã‚‹ã“ã¨ãŒã§ã,
ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚„å®Ÿè¡Œé€Ÿåº¦ã®æœ€é©åŒ–ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œãªã„.

Clojureã§ã¯, **^** ã¨ã„ã†è¨˜å·ã‚’ Record/Type/Protocol/Java Classã«è¨­å®šã—ã¦å¤‰æ•°ã‚’å®£è¨€ã™ã‚‹ã“ã¨ã§å‹ãƒ’ãƒ³ãƒˆã‚’å®Ÿç¾ã™ã‚‹.

---

ref: [[Clojure] å‹ã‚’æŒ‡å®šã™ã‚‹ã¨é€Ÿã„Â |Â Basic Werk](http://basicwerk.com/blog/archives/1479)

Clojureã¯å‹ãƒ’ãƒ³ãƒˆã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’åŠ©ã‘ã‚‹ã“ã¨ã§,
ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é‡è¦ãªã‚³ãƒ¼ãƒ‰é ˜åŸŸã«å¯¾ã—ã¦ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¿ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹.

Clojureã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ãŠã‘ã‚‹Javaã®åŸºæœ¬å‹ã‚’ä½¿ã£ãŸé«˜é€Ÿãªè¨ˆç®—ã‚„ç®—è¡“æ¼”ç®—ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹.
ã™ã¹ã¦ã®JavaåŸºæœ¬å‹ï¼ˆint, float, long, double, boolean, char, short, byteï¼‰ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã€‚


## Active Recalls {#active-recalls}


### Clojureã‹ã‚‰Javaã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã™ã«ã¯ï¼Ÿ {#clojureã‹ã‚‰javaã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã™ã«ã¯}

ãƒ¡ã‚½ãƒƒãƒ‰åã®å‰ã«.ã‚’ãŠã„ã¦å‘¼ã³å‡ºã™. (.methodName )


### Clojureã‹ã‚‰Javaã®ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã«ã¯ï¼Ÿ {#clojureã‹ã‚‰javaã®ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã«ã¯}

ã‚¯ãƒ©ã‚¹åã®ã‚ã¨ã«.ã‚’ãŠã„ã¦å‘¼ã³å‡ºã™. (Classname. )
