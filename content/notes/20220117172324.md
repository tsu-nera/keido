+++
title = "ğŸ“Clojure Java Interop"
tags = ["WIKI"]
draft = false
+++

up: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}}) refs: [ğŸ·Java]({{< relref "20220303203801.md" >}})

Clojureã¨Javaã®ã‚„ã‚Šã¨ã‚Šã‚’ã¾ã¨ã‚.


## Clojureã‹ã‚‰Javaã‚’å‘¼ã³å‡ºã— {#8f6763}

-   ãƒ¡ã‚½ãƒƒãƒ‰ã‚’å‘¼ã¶ã«ã¯, ãƒ¡ã‚½ãƒƒãƒ‰åã®å‰ã« **.** ã‚’æ›¸ã.
-   ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã«ã¯, ã‚¯ãƒ©ã‚¹åã®ã‚ã¨ã« **.** ã‚’æ›¸ã.


## Clojureã‹ã‚‰Javaã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’åˆ©ç”¨ã™ã‚‹ {#e01225}

æœ€ã‚‚å¤§äº‹ã‹ã‚‚ã—ã‚Œãªã„ãƒˆãƒ”ãƒƒã‚¯.

[twitter-text/java](https://github.com/twitter/twitter-text/tree/master/java) ã‚’Clojureã‹ã‚‰åˆ©ç”¨ã—ãŸã„ã¨ã™ã‚‹. ã“ã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã¯Clojureã‹ã‚‰ä½¿ã£ã¦ã„ã‚‹äººãŒã»ã¼ã„ãªã„.


### Java Libraryã®Clojureãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã¸ã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«(deps.edn) {#8706f6}

ã¾ãšå¤§æŠµã®Java libraryã¯mvnçµŒç”±ã§ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ã, ãŸã¨ãˆã°GitHubã®README.mdã«ã¯ã“ã‚“ãªæ„Ÿã˜ã®xmlãŒã‚ã‚‹.

```xml
  <dependencies>
    <dependency>
      <groupId>com.twitter.twittertext</groupId>
      <artifactId>twitter-text</artifactId>
      <version>3.1.0</version> <!-- or whatever the latest version is -->
    </dependency>
  </dependencies>
```

deps.ednã«ã¯ä»¥ä¸‹ã®ã‚ˆã†ã« **<groupId>/<artifactId> {:mvn/version <version>}** ã¨è¨˜è¿°ã™ã‚Œã°ã„ã„.

```clojure
com.twitter.twittertext/twitter-text {:mvn/version "3.1.0"}
```

ã“ã‚Œã§Clojureã®ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã¨åŒã˜ã‚ˆã†ã«ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã§ãã‚‹.


### Java Libraryã‚’Clojureã‚½ãƒ¼ã‚¹ã‹ã‚‰èª­ã¿è¾¼ã¿(import) {#fa627f}

[twitter-text/TwitterTextParser.java](https://github.com/twitter/twitter-text/blob/master/java/src/main/java/com/twitter/twittertext/TwitterTextParser.java) ã‚’ä½¿ã†ã¨ã™ã‚‹.

ã«ã¯ com.twitter.twittertextã®ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã‚’ **import** ã™ã‚‹. packageã¯ã‚½ãƒ¼ã‚¹ã‚’è¦—ãã¨ **package** ã¨ã„ã†å®£è¨€ã®ã‚ã¨ã«pathãŒã‚ã‚‹.

ä»¥ä¸‹ã®ã‚ˆã†ã«importã—ã¦ã¤ã‹ã†.

```clojure
(ns dev
  (:import
   (com.twitter.twittertext
    TwitterTextParser)))
```


## Clojure-Java HashMap Interop {#88e7e9}


### howto: Clojure - Javaã®Hashmapã®å¤‰æ› {#749eb7}

```clojure
(def java-map (java.util.HashMap. test-data))
(def clj-map  (into {} java-map))
```


### howto: Clojureã®keywordã‚’ stringã«ã™ã‚‹ã«ã¯ï¼Ÿ {#4934c1}

clojure.walkãƒ©ã‚¤ãƒ–ãƒ©ãƒªä½¿ãˆã‚‹. <https://clojuredocs.org/clojure.walk>

-   stringify-keys: keywords to string
-   keywordize-keys: string to keywords


## Clojure-Java Class {#bbbfb7}


### howto: Javaã®classã‚’ç”Ÿæˆã™ã‚‹ã«ã¯? {#fe144d}

ref: <https://clojure.org/reference/compilation>

namespaceã« (:gen-class)ã‚’è¨˜è¿°ã™ã‚‹.
namespaceã‚’æŒã¤ .classãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œã‚‹.

default(AOT compile?) ã§ã¯ compileã™ã‚‹ã¨ãƒãƒ©ãƒãƒ©ã®ãƒ•ã‚¡ã‚¤ãƒ«ãŒç”Ÿæˆã•ã‚Œ, .classãŒãªã„.

```text
drwxr-xr-x 3 tsu-nera tsu-nera 4.0K  2æœˆ 16 13:40  ClojureHelloWorld
-rw-r--r-- 1 tsu-nera tsu-nera 1.4K  2æœˆ 16 13:40 'ClojureHelloWorld$fn__273.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.1K  2æœˆ 16 13:40 'ClojureHelloWorld$fn__275$fn__276.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.3K  2æœˆ 16 13:40 'ClojureHelloWorld$fn__275.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.9K  2æœˆ 16 13:40 'ClojureHelloWorld$loading__6737__auto____271.class'
-rw-r--r-- 1 tsu-nera tsu-nera 1.1K  2æœˆ 16 13:40  ClojureHelloWorld.clj
-rw-r--r-- 1 tsu-nera tsu-nera 2.4K  2æœˆ 16 13:40  ClojureHelloWorld__init.class
```


### howto: Javaã®ã‚¹ãƒ¼ãƒ‘ãƒ¼ã‚¯ãƒ©ã‚¹ã‚’Clojureã§ç¶™æ‰¿ã™ã‚‹ã«ã¯ï¼Ÿ {#ab76df}

**proxy** ãƒã‚¯ãƒ­ã‚’ã¤ã‹ã†.
ã“ã‚Œã¯Javaã®ã‚¯ãƒ©ã‚¹ã‚’å¼•æ•°ã«ã—ã¦ç„¡åã®ã‚µãƒ–ã‚¯ãƒ©ã‚¹ã‚’è¿”ã™ã®ã§é©å½“ãªå€¤ã«bindã™ã‚‹.

ref: <https://clojure.org/reference/java_interop#_implementing_interfaces_and_extending_classes>


## Clojure: å‹ãƒ’ãƒ³ãƒˆ(Type Hinting) {#26eed20d-611d-46c4-bd37-d60c2f20a1d7}

[Clojure - Java Interop](https://clojure.org/reference/java_interop#typehints)

Clojureã¯å‹•çš„å‹ä»˜ã‘è¨€èªã ãŒå‹•çš„å‹ä»˜ã‘è¨€èªã®Javaã®ä¸Šã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚, æš—é»™çš„ãªå‹ã¯ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦å‹æ¨è«–ã•ã‚Œã¦ã„ã‚‹.

ãã®ãŸã‚å‹hintã‚’è¨­å®šã™ã‚‹ã“ã¨ã§å‹æ¨è«–ã®åŠ¹ç‡åŒ–ã‚’ã™ã‚‹ã“ã¨ãŒã§ã, ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚„å®Ÿè¡Œé€Ÿåº¦ã®æœ€é©åŒ–ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œãªã„.

Clojureã§ã¯, **^** ã¨ã„ã†è¨˜å·ã‚’ Record/Type/Protocol/Java Classã«è¨­å®šã—ã¦ å¤‰æ•°ã‚’å®£è¨€ã™ã‚‹ã“ã¨ã§å‹ãƒ’ãƒ³ãƒˆã‚’å®Ÿç¾ã™ã‚‹.

---

ref: [[Clojure] å‹ã‚’æŒ‡å®šã™ã‚‹ã¨é€Ÿã„Â |Â Basic Werk](http://basicwerk.com/blog/archives/1479)

Clojureã¯å‹ãƒ’ãƒ³ãƒˆã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’åŠ©ã‘ã‚‹ã“ã¨ã§, ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é‡è¦ãªã‚³ãƒ¼ãƒ‰é ˜åŸŸã«å¯¾ã—ã¦ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¿ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹.

Clojureã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ãŠã‘ã‚‹Javaã®åŸºæœ¬å‹ã‚’ä½¿ã£ãŸé«˜é€Ÿãªè¨ˆç®—ã‚„ç®—è¡“æ¼”ç®—ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹. ã™ã¹ã¦ã®JavaåŸºæœ¬å‹ï¼ˆint, float, long, double, boolean, char, short, byteï¼‰ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã€‚


## Active Recalls {#b27a23}


### Clojureã‹ã‚‰Javaã®ãƒ¡ã‚½ãƒƒãƒ‰ã®å‘¼ã³å‡ºã™ã«ã¯ï¼Ÿ {#3e6acd}

ãƒ¡ã‚½ãƒƒãƒ‰åã®å‰ã«.ã‚’ãŠã„ã¦å‘¼ã³å‡ºã™. (.methodName )


### Clojureã‹ã‚‰Javaã®ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã«ã¯ï¼Ÿ {#96b598}

ã‚¯ãƒ©ã‚¹åã®ã‚ã¨ã«.ã‚’ãŠã„ã¦å‘¼ã³å‡ºã™. (Classname. )


## References {#d95867}

-   [Clojure-Java Exception Interop]({{< relref "20220331055419.md#afb4936b-9d05-4e5f-bfc7-5071962c34d4" >}})
