+++
title = "ğŸ“Clojure Collections and Sequences"
tags = ["WIKI"]
draft = false
+++

refs: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}})

Clojureã®ã‚·ãƒ¼ã‚±ãƒ³ã‚¹ã‚„é«˜éšé–¢æ•°ã‚’å·§ã¿ã«æ‰±ã†ã“ã¨ãŒã§ãã‚‹ã¨ãƒ¢ãƒ†ã‚‹ã¨ã‹.
ã“ã†ã„ã†ã®ã¯çŸ¥ã£ã¦ã„ã‚‹ã‹çŸ¥ã‚‰ãªã„ã‹ãªã®ã§ã‚¤ãƒ‡ã‚£ã‚ªãƒ ã‚’è¦šãˆã¦ãƒ¢ãƒ†ã‚ˆã†.

-&gt; [ğŸ“Clojure Idioms]({{< relref "20220302101805.md" >}})


## Clojure: Collections {#clojure-collections}

Clojureã®Collectionã¯immutableã§persistent.

---

-   refs
    -   [ğŸ“immutable]({{< relref "20220114074914.md#immutable" >}})
    -   [ğŸ“persistent]({{< relref "20220114074914.md#persistent" >}})
    -   [ã‚¤ãƒŸãƒ¥ãƒ¼ã‚¿ãƒ–ãƒ«æ™‚ä»£ã®è¨€èªã¨ã—ã¦ã®Clojure - Qiita](https://qiita.com/kawasima/items/c695e2f4ee079a6debf5)


### Clojure Collectionæ“ä½œ {#clojure-collectionæ“ä½œ}

ã‚ˆãä½¿ã†ã‚‚ã®ã‚’åˆ—æŒ™.

-   conj: ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã®çµåˆ. ä»–ã®è¨€èªã§ã¯push, concat, appendã¨ã‹.


### fnil {#fnil}

<https://clojuredocs.org/clojure.core/fnil>

ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’ã—ã‚ˆã†ã¨ã—ãŸã¨ãã«,
å¼•æ•°ã§ã‚‚ã‚‰ã£ãŸãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒnilã®å ´åˆã¯åˆæœŸå€¤ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ç½®ãæ›ãˆã‚‹.

```clojure
(update request ::acc (fnil conj []) id)
```

ã“ã‚Œã®ã‚„ã‚ã†ã¨ã—ã¦ã„ã‚‹ã“ã¨ã¯,
request mapã® ::accã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚ã‚‹vectorã«idã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã™ã‚‹ãŒ,
:acc ãŒrequest mapã«ãªã„ã¨ãã¯ç©ºã®vectorã‚’ç”¨æ„ã—ã¦ã•ã‚‰ã«idã‚’åŠ ãˆã‚‹.


## Clojure Sequences(clojure.core.sequence) {#clojure-sequences--clojure-dot-core-dot-sequence}

refs: [Clojure - Clojureã‚’å­¦ã¼ã† - ã‚·ãƒ¼ã‚±ãƒ³ã‚·ãƒ£ãƒ«ãªã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³](https://japan-clojurians.github.io/clojure-site-ja/guides/learn/sequential_colls)

ã‚·ãƒ¼ã‚±ãƒ³ã‚¹å‹ ã«ã¯4ç¨®é¡ã®é‡è¦ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒã‚ã‚‹.

-   list: ()
-   vector: []
-   map: {}
-   set: #{}


## Clojure Map(clojure.core.map) {#clojure-map--clojure-dot-core-dot-map}

-   assoc: (key, value)ã®è¿½åŠ 
-   dissoc: (key, value)ã®å‰Šé™¤
-   update: (key)ã®æŒ‡ã™(value)ã«å¼•æ•°ã§ä¸ãˆã‚‰ã‚ŒãŸé–¢æ•°ã‚’é©ç”¨ã—ã¦ç½®ãæ›ãˆã‚‹.
-   merge: (key, value)ã®é›†åˆã®è¿½åŠ 

assocã¯å€¤ã‚’æ›´æ–°ã—ã¦Mapã‚’è¿”ã™, updateã¯å€¤ã«é–¢æ•°ã‚’é©ç”¨ã—ã¦Mapã«æŸç¸›ã™ã‚‹.
ã“ã®é–¢ä¿‚ã¯, [atomã§ã®reset! ã¨swap!ã®é•ã„]({{< relref "20220116191927.md#clojure-atom" >}}) ã«ä¼¼ã¦ã„ã‚‹.


## Clojureã«ãŠã‘ã‚‹Sequenceã¨Collectionã®é•ã„ {#clojureã«ãŠã‘ã‚‹sequenceã¨collectionã®é•ã„}

Clojureã§ã¯Collectionã¨Sequenceã¯ç•°ãªã‚‹æ¦‚å¿µ.

-   collection: ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æŠ½è±¡.
-   sequence: collectionã®ä¸­ã§ãƒ‡ãƒ¼ã‚¿ã‚’é †æ¬¡ã‚¢ã‚¯ã‚»ã‚¹å¯èƒ½(ã‚·ãƒ¼ã‚«ãƒ–ãƒ«)ãªã‚‚ã®.

Sequenceã¯Collectionã®ç‰¹æ®Šãªå½¢æ…‹ã§ã‚ã‚Šã€Collectionã‚’è¡¨ç¾ã™ã‚‹æ–¹æ³•ã®1ã¤.

å®Ÿè£…ãƒ¬ãƒ™ãƒ«ã§ã¯ coll?ã§çœŸãŒå¤‰ãˆã‚Œã°collection, seq?ã§çœŸãŒå¤‰ãˆã‚Œã°sequence.

collectionã¯IPersistentCollectionã¨ã„ã†ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‚‚ã®.
IPersistentCollectionã¯5ã¤ã®ãƒ¡ã‚½ãƒƒãƒ‰ï¼ˆcount, cons, empty, equiv, seqï¼‰ã‹ã‚‰ãªã‚‹.

sequenceã¯ISeqã¨ã„ã†ã‚¤ãƒ³ã‚¿ãƒ•ã‚§ãƒ¼ã‚¹ã‚’å®Ÿè£…ã—ã¦ã„ã‚‹ã‚‚ã®.
ISeqã¯(first, next, more, cons)ã‹ã‚‰ãªã‚‹.

---

-   ref: Clojureã«ãŠã‘ã‚‹ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æŠ½è±¡åŒ–ã‚’ç†è§£ã—ã¦ç‹¬è‡ªã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®Ÿè£…ã™ã‚‹
    -   [Part 1: Collectionã¨ã¯ä½•ã‹ - æœ¬å½“ã¯æ€–ã„HPC](https://freak-da.hatenablog.com/entry/2015/08/05/222224)
    -   [Part 2: Sequenceã¨ã¯ä½•ã‹ - æœ¬å½“ã¯æ€–ã„HPC](https://freak-da.hatenablog.com/entry/2015/08/11/180047)


### ğŸ’¡Clojureãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œé–¢æ•°ã®åˆ†é¡ {#clojureãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œé–¢æ•°ã®åˆ†é¡}

Clojureã®é–¢æ•°ã¯å¤§ããåˆ†ã‘ã¦ï¼’ã¤ã®ç¨®é¡ã«åˆ†ã‘ã‚‰ã‚Œã‚‹.

-   ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã®æ“ä½œã®é–¢æ•°(conj, disj, assoc, dissoc...)
-   ã‚·ãƒ¼ã‚±ãƒ³ã‚¹æ“ä½œã®é–¢æ•°(cons, map, filter, reduce..)

ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’æ“ä½œã™ã‚‹é–¢æ•°ã¯é–¢æ•°ã®æ¬¡ã«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å—ã‘ã‚‹.
ä¸€æ–¹ã‚·ãƒ¼ã‚±ãƒ³ã‚¹æ“ä½œã¯é–¢æ•°è©•ä¾¡å¼ã®æœ€å¾Œã«ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å—ã‘ã‚‹.

[Clojure: Threading Macros]({{< relref "20220116162321.md#clojure-threading-macros" >}}) ã«ã‚‚ 2ç¨®é¡ã‚ã‚‹ã®ã‚‚ã“ã‚ŒãŒé–¢ä¿‚ã—ã¦ã„ã‚‹.

ref: [Clojure - Frequently Asked Questions](https://clojure.org/guides/faq#seqs_vs_colls)


## âœ…Active Recalls {#active-recalls}


### Clojureã®Collectionã¨Sequenceã®é•ã„ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojureã®collectionã¨sequenceã®é•ã„ã¯ãªã‚“ã§ã™ã‹}

Collectionã¯ãƒ‡ãƒ¼ã‚¿é›†åˆ.
Sequenceã¯Collectionã«é †æ¬¡ã‚¢ã‚¯ã‚»ã‚¹ã®æ“ä½œãŒã¤ã„ãŸã‚‚ã®.


### Clojure ã®list, vector, map, setã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹? {#clojure-ã®list-vector-map-setã®ã‚·ãƒ³ã‚¿ãƒƒã‚¯ã‚¹ã¯ãªã‚“ã§ã™ã‹}

ãã‚Œãã‚Œï¼Œ(), [], {}, #{}


### Clojureã®mapã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã¨å‰Šé™¤ã‚’ã™ã‚‹é–¢æ•°ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#clojureã®mapã«ãƒ‡ãƒ¼ã‚¿ã‚’è¿½åŠ ã¨å‰Šé™¤ã‚’ã™ã‚‹é–¢æ•°ã¯ãªã‚“ã§ã™ã‹}

assocã¨dissoc


### âœ… anki: assoc, update ã®é•ã„ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#anki-assoc-update-ã®é•ã„ã¯ãªã‚“ã§ã™ã‹}

assoc ã¯ key ã«å¯¾ã—ã¦æ–°ã—ã„ val ã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ãŸMapã‚’è¿”ã™.

update ã¯å¤ã„valã«å¯¾ã—ã¦é–¢æ•°ã‚’é©ç”¨ã—å¾—ãŸæ–°ã—ã„valã‚’ãƒãƒƒãƒ”ãƒ³ã‚°ã—ãŸMapã‚’è¿”ã™.
