+++
title = "ğŸ“Clojureé«˜é€ŸåŒ–"
tags = ["WIKI"]
draft = false
+++

[ğŸ“‚Clojureé–‹ç™º]({{< relref "20220211141917.md" >}})

Clojureã®æ€§èƒ½æœ€é©åŒ–ã‚„é«˜é€ŸåŒ–ã«ã¤ã„ã¦ã®ãƒˆãƒ”ãƒƒã‚¯ã¾ã¨ã‚.


## main.coreã§AOT(gen-class) {#main-dot-coreã§aot--gen-class}

Clojureã¯å‹•çš„ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã®ãŸã‚, ã„ã‚ã‚†ã‚‹JITæ–¹å¼ã§Javaã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚’ã™ã‚‹ãŒ, [AOT compilation]({{< relref "20220214050955.md#aot-compilation" >}}) ã‚’ã™ã‚‹ã«ã¯ **gen-class** ã‚’ã¤ã‹ã†.

[Clojure - Ahead-of-time Compilation and Class Generation](https://clojure.org/reference/compilation)

ã“ã‚Œã‚’namespaceã®å®£è¨€ã§ã¤ã‹ã†ã“ã¨ã«ã‚ˆã£ã¦Javaã®ã‚¯ãƒ©ã‚¹ã‚’äº‹å‰ã«ç”Ÿæˆã™ã‚‹ã‚ˆã†ã«ãªã‚‹. Java Classã‚’ç”Ÿæˆã™ã‚‹ã“ã¨ã®ãƒ¡ãƒªãƒƒãƒˆã¯ã„ã‚ã„ã‚ã‚ã‚‹ã‚ˆã†ã ãŒ, ãŸã¨ãˆã° xxxx.coreã¨ã„ã†ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã®ãƒ¡ã‚¤ãƒ³namespaceã«å®šç¾©ã•ã‚ŒãŸ -mainé–¢æ•°ã‚’[clojure cli]({{< relref "20220119063524.md#clojure-cli-tools-dot-deps-clojure-build-tool" >}})ã‹ã‚‰å®Ÿè¡Œã™ã‚‹å ´åˆ, gen-classã‚’å®£è¨€ã—ã¦ãŠãã“ã¨ã«ã‚ˆã£ã¦ãƒ—ãƒ­ã‚°ãƒ©ãƒ å®Ÿè¡Œã®èµ·å‹•ãŒé€Ÿããªã‚‹.


## å‹ãƒ’ãƒ³ãƒˆ(Type Hinting) {#å‹ãƒ’ãƒ³ãƒˆ--type-hinting}

-   [Clojure - Java Interop](https://clojure.org/reference/java_interop#typehints)

Clojureã¯å‹•çš„å‹ä»˜ã‘è¨€èªã ãŒå‹•çš„å‹ä»˜ã‘è¨€èªã®Javaã®ä¸Šã«æ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹ãŸã‚, æš—é»™çš„ãªå‹ã¯ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã«ã‚ˆã£ã¦å‹æ¨è«–ã•ã‚Œã¦ã„ã‚‹.

ãã®ãŸã‚å‹hintã‚’è¨­å®šã™ã‚‹ã“ã¨ã§å‹æ¨è«–ã®åŠ¹ç‡åŒ–ã‚’ã™ã‚‹ã“ã¨ãŒã§ã, ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã‚„å®Ÿè¡Œé€Ÿåº¦ã®æœ€é©åŒ–ã‚’ã™ã‚‹ã“ã¨ãŒã§ãã‚‹ã‹ã‚‚ã—ã‚Œãªã„.

Clojureã§ã¯, **^** ã¨ã„ã†è¨˜å·ã‚’ Record/Type/Protocol/Java Classã«è¨­å®šã—ã¦ å¤‰æ•°ã‚’å®£è¨€ã™ã‚‹ã“ã¨ã§å‹ãƒ’ãƒ³ãƒˆã‚’å®Ÿç¾ã™ã‚‹.

---

ref: [[Clojure] å‹ã‚’æŒ‡å®šã™ã‚‹ã¨é€Ÿã„Â |Â Basic Werk](http://basicwerk.com/blog/archives/1479)

Clojureã¯å‹ãƒ’ãƒ³ãƒˆã‚’ä½¿ã£ã¦ã‚³ãƒ³ãƒ‘ã‚¤ãƒ©ã‚’åŠ©ã‘ã‚‹ã“ã¨ã§, ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã®é‡è¦ãªã‚³ãƒ¼ãƒ‰é ˜åŸŸã«å¯¾ã—ã¦ãƒªãƒ•ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‚’é¿ã‘ã‚‹ã“ã¨ãŒã§ãã‚‹.

Clojureã¯ãƒ­ãƒ¼ã‚«ãƒ«ã‚³ãƒ³ãƒ†ã‚­ã‚¹ãƒˆã«ãŠã‘ã‚‹Javaã®åŸºæœ¬å‹ã‚’ä½¿ã£ãŸé«˜é€Ÿãªè¨ˆç®—ã‚„ç®—è¡“æ¼”ç®—ã‚’ã‚µãƒãƒ¼ãƒˆã™ã‚‹. ã™ã¹ã¦ã®JavaåŸºæœ¬å‹ï¼ˆint, float, long, double, boolean, char, short, byteï¼‰ãŒã‚µãƒãƒ¼ãƒˆã•ã‚Œã¦ã„ã‚‹ã€‚


## ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãƒ’ãƒ³ãƒˆ(primitive hiting) {#ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãƒ’ãƒ³ãƒˆ--primitive-hiting}

ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãƒ’ãƒ³ãƒˆã¯ boxing ã‚’é¿ã‘ã‚‹ãŸã‚ã®ã‚‚ã®.

```clojure
(defn ->spread ^double [^double ask ^double bid]
  (- ask bid))
```

---

-   refs
    -   [å‹ãƒ’ãƒ³ãƒˆã¯ãƒ—ãƒªãƒŸãƒ†ã‚£ãƒ–ãƒ’ãƒ³ãƒˆã¨ç›¸æ€§ãŒæ‚ªã„ï¼Ÿ - tnoda-clojure](https://tnoda-clojure.tumblr.com/post/50280501176/type-hinting-and-primitive-hinting)


## ç„¡æ¤œæŸ»æ¼”ç®— {#ç„¡æ¤œæŸ»æ¼”ç®—}

Clojureã¯ç„¡æ¤œæŸ»æ¼”ç®—ãŒä½¿ãˆã‚‹. **unchecked-add**. å‹ãƒ’ãƒ³ãƒˆã§ã‚‚ååˆ†é«˜é€ŸåŒ–ã§ãã‚‹ãŒ, unchecked-addã‚’ã¤ã‹ã†ã¨ã‚‚ã†å°‘ã—ã ã‘ç®—è¡“æ¼”ç®—ã¯é«˜é€ŸåŒ–ã§ãã‚‹.
