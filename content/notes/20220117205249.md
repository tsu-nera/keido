+++
title = "ğŸ“Clojure REPL Driven Development"
tags = ["WIKI"]
draft = false
+++

[ğŸ·Clojure]({{< relref "20211111225741.md" >}}) [ğŸ·ã‚½ãƒ•ãƒˆã‚¦ã‚§ã‚¢é–‹ç™ºæ‰‹æ³•]({{< relref "20220214053235.md" >}})

REPL-Oriented Programmingã¨ã‚‚. RDDã¨ç•¥ã•ã‚ŒãŸã‚Šã‚‚ã™ã‚‹.

ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’å³æ™‚ã«ã‚¨ãƒ‡ã‚£ã‚¿ã§è©•ä¾¡ã—ã¦ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³è¡¨ç¤ºãªã©ã™ã‚‹ã“ã¨ã§ï¼Œç´ æ—©ããƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’ãˆã‚‹ã“ã¨ãŒã§ãã‚‹.

æ­£ç¢ºã«ã¯REPLã«ã‚¨ãƒ‡ã‚£ã‚¿ã‹ã‚‰ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã‚’è©•ä¾¡ã—ãŸçµæœã‚’ã‚‚ã‚‰ã£ãŸã‚‚ã®ã‚’è¡¨ç¤ºã ãŒï¼Œæ“ä½œçš„ã«ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã¨å¯¾è©±ã™ã‚‹ã‚ˆã†ã«é–‹ç™ºãŒã§ãã‚‹.

TDDã¯ç´°ã‹ããƒ†ã‚¹ãƒˆã‚’æ›¸ãã“ã¨ã§ç´ æ—©ããƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¾—ã‚‹ã“ã¨ã§å…ˆã®ä¸å®‰ã‚’äº‹å‰ã«å–ã‚Šé™¤ãå‰ã«é€²ã‚€ãŸã‚ã®ç¢ºä¿¡ã‚’å¾—ã‚‹ã“ã¨ãŒç›®çš„ã®ã²ã¨ã¤ã ã£ãŸ. ç¶™ç¶šçš„ã‚¤ãƒ³ãƒ†ã‚°ãƒ¬ãƒ¼ã‚·ãƒ§ãƒ³ï¼Œç¶™ç¶šçš„ãƒ‡ãƒªãƒãƒªãƒ¼ãªã©ã‚‚.
ãã‚Œã‚‰ã®ã‚µã‚¤ã‚¯ãƒ«ã®å˜ä½ã‚ˆã‚Šã‚‚RDDã¯åœ§å€’çš„ã«ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ãŒæ—©ã„! ã‚‚ã¯ã‚„æœ€å°å˜ä½.


## REPLã¨ã¯ {#replã¨ã¯}

REPLã¨ã¯ä»¥ä¸‹ã®ç•¥.

-   read
-   evaluate
-   print
-   loop

REPLã®èª¬æ˜ã¯ä»¥ä¸‹ãŒã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸ. å°‘ã—æŠœç²‹.

ref: [ğŸ”—REPL Driven Programming - tyano's Techlog](https://tyano.shelfinc.com/post/48110396231/repl-driven-programming)

REPLã§namespaceã‚’èª­ã¿è¾¼ã‚€ã¨ã„ã†ã“ã¨ã¯ç°¡æ˜“å®Ÿè¡Œç’°å¢ƒã§ã¯ãªã **ã‚ãªãŸãŒæ›¸ã„ãŸãƒ—ãƒ­ã‚°ãƒ©ãƒ å†…éƒ¨ã«æ½œã‚Šè¾¼ã‚“ã§ã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã‚’é–‹ã„ãŸçŠ¶æ…‹** ãã®ã‚‚ã®. Clojureã«ã‚¤ãƒ³ã‚¿ãƒ¼ãƒ—ãƒªã‚¿ã¯å­˜åœ¨ã—ãªã„. é–¢æ•°ã‚’ãƒã‚¤ãƒˆã‚³ãƒ¼ãƒ‰ã«ã—ã¦å®Ÿè¡Œã™ã‚‹ã®ã¿.

---

Road to Common Lispã®ä¸­ã§ [Lisp as a System](https://gist.github.com/y2q-actionman/49d7587912b2786eb68643afde6ca192#lisp-as-a-system) ã¨ã„ã†ç« ã‚‚ï¼Œä¾‹é¡ŒãŒCommon Lispã§ã¯ã‚ã‚‹ã‚‚ã®ã®å®Ÿä½“ã¯RDD.

1.  Lispãƒ—ãƒ­ã‚»ã‚¹ã‚’èµ·å‹•ã€‚
2.  ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆã‚’èª­ã¿è¾¼ã‚€ã€‚
3.  ã‚³ãƒ¼ãƒ‰ã‚’ã‚¨ãƒ‡ã‚£ã‚¿ã§ç·¨é›†ã€‚
4.  å‹•ä½œä¸­ã®ãƒ—ãƒ­ã‚»ã‚¹ã«ã€ç·¨é›†ã—ãŸã‚³ãƒ¼ãƒ‰ã ã‘ã‚’ã‚³ãƒ³ãƒ‘ã‚¤ãƒ«ã•ã›ã‚‹ã€‚
5.  ãƒ—ãƒ­ã‚»ã‚¹ä¸­ã®å¤‰æ›´ã—ãŸã‚³ãƒ¼ãƒ‰ã¨å¯¾è©±ã€‚ REPL ã‚„ HTTP request ãªã©ã‚’é€šã—ã¦è¡Œã†ã€‚
6.  å‡ºåŠ›ã‚’èª¿æŸ» ï¼ˆã‚³ãƒ³ã‚½ãƒ¼ãƒ«ã€ãƒ–ãƒ©ã‚¦ã‚¶ãªã©ã§ï¼‰ã€‚3ã«æˆ»ã‚‹ã€‚

&gt; Common Lispã‚’æ›¸ãã“ã¨ã¯ã€ç”Ÿç‰©ã‚„å‘¼å¸ã™ã‚‹çµ„ç¹”ã¨ã‚„ã‚Šã¨ã‚Šã™ã‚‹ã“ã¨ã€ã‚‚ã—ãã¯ ç†±å¿ƒãªåŠ©æ‰‹ã«ç‰©äº‹ã‚’æ•™ãˆã‚‹ã“ã¨ã®ã‚ˆã†ã«æ„Ÿã˜ã‚‹ã“ã¨ãŒã§ãã¾ã™ã€‚

ref: [ğŸ’»A Road to Common Lisp - Steve Losh(2018)]({{< relref "20220110033325.md" >}})


## Emacsã§ã®Clojure REPL Driven Developmentã®å…·ä½“çš„ãªæ–¹æ³• {#emacsã§ã®clojure-repl-driven-developmentã®å…·ä½“çš„ãªæ–¹æ³•}

-   M-x cider-jack-in (REPLã«Emacsã‹ã‚‰æ¥ç¶š)
    -   M-x cider-load-file (ãƒ•ã‚¡ã‚¤ãƒ«å˜ä½ã§evaluate)
    -   M-x cider-eval-last-sexp (ãƒ•ã‚©ãƒ¼ãƒ å˜ä½ã§evaluate &amp; ã‚¤ãƒ³ãƒ©ã‚¤ãƒ³ã§çµæœè¡¨ç¤º)
    -   M-x cider-eval-last-sexp-to-repl(ãƒ•ã‚©ãƒ¼ãƒ å˜ä½ã§REPLã«é€ä¿¡ã—ã¦evaluate)

ref: ğŸ”—[Column: REPL é§†å‹•é–‹ç™ºã‚’å–ã‚Šå…¥ã‚Œã¦ Ring ã§ã‚‚ã†å°‘ã—éŠã‚“ã§ã¿ã‚‹ â€” Clojure ã®æ—¥æœ¬èªã‚¬ã‚¤ãƒ‰](http://ayato-p.github.io/clojure-beginner/intro_web_development/column_rdd_and_more_ring.html)


## Design Journal {#design-journal}

RDDã§ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ãã¨ï¼Œã¾ãšã”ã«ã‚‡ã”ã«ã‚‡ã¨ã‚¢ã‚¤ãƒ‡ã‚¢ã‚’æ–‡ã§æ›¸ã„ãŸã‚Šãã‚Œã‚’å°ã•ãªé–¢æ•°ã§å®Ÿè£…ã—ã¦è©•ä¾¡ã—ã¦ã¿ãŸã‚Šã‚’ç¹°ã‚Šè¿”ã—ãªãŒã‚‰ï¼Œã¤ã¾ã‚Šã‚¨ãƒ‡ã‚£ã‚¿ã¨å¯¾è©±ã—ãªãŒã‚‰å°ã•ãªéƒ¨å“ã‚’çµ„ã¿ç«‹ã¦ã¦ã„ãï¼Œãã‚Œã‚‰ã‚’çµ„ã¿åˆã‚ã›ã¦å¤§ããªæ©Ÿèƒ½ã‚’ã¤ãã‚‹.

ãã®ã”ã«ã‚‡ã”ã«ã‚‡ã®éƒ¨åˆ†ã¯ã‚½ãƒ¼ã‚¹ã‚³ãƒ¼ãƒ‰ã®ä¸‹ã®ã»ã†ã«ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã—ã¤ã¤æ®‹ã—ã¦ãŠãã“ã¨ã§ï¼Œã©ã†ã„ã†è¨­è¨ˆæ„å›³ãŒã‚ã£ã¦ã“ã®ã‚³ãƒ¼ãƒ‰ã‚’å®Ÿè£…ã—ãŸã®ã‹ã®å±¥æ­´ã‚’ï¼Œã‚³ãƒ¼ãƒ‰ã¨ã¨ã‚‚ã«æ®‹ã—ã¦ãŠã“ã†ã¨ã„ã†è€ƒãˆ.

ã“ã†ã„ã†ã“ã¨ãŒã§ãã‚‹ã®ã¯ï¼ŒREPLã§é–¢æ•°ã‚’ã‹ã‚“ãŸã‚“ã«è©•ä¾¡ã§ãã‚‹ã¨ã„ã†ã“ã¨ã‚‚ã‚ã‚‹ãŒï¼Œåˆ¥ã®å´é¢ã¨ã—ã¦ã¯ClojureãŒé–¢æ•°å‹è¨€èªãªã®ã§ç°¡æ½”ã«å‰¯ä½œç”¨ã‚‚ãªãéƒ¨å“ã¨ã—ã¦ã‚³ãƒ¼ãƒ‰ã‚’æ®‹ã—ã‚„ã™ã„ã¨ã„ã†å´é¢ãŒã‚ã‚‹(ã¨å€‹äººçš„ã«ã¯æ€ã£ã¦ã„ã‚‹).

å®Ÿéš›ã® [Design Journalå®Ÿæ–½ä¾‹](https://github.com/practicalli-john/tictactoe-reagent/blob/master/src/tictactoe_reagent/core.cljs#L124) ã¯ã“ã¡ã‚‰.

ref: [REPL Driven Development - DEV Community](https://dev.to/jr0cket/repl-driven-development-ano)


### Design Journal Tisp with Clojure Cider {#design-journal-tisp-with-clojure-cider}

**comment** ãƒã‚¯ãƒ­ã‚’ã¤ã‹ã†ã¨ã¾ã¨ã‚ã¦ã‚³ãƒ¡ãƒ³ãƒˆã‚¢ã‚¦ãƒˆã§ãã‚‹.

å¼ã®è©•ä¾¡çµæœã‚’ãã®ã¾ã¾æ¬¡ã®è¡Œã«å‡ºåŠ›ã™ã‚‹ã¨å¾Œã§æ€ã„å‡ºã™ã¨ãã«ã„ã¡ã„ã¡è©•ä¾¡ã—ãªãã¦ã‚‚ã„ã„.

-   M-x cider-pprint-eval-defun-to-comment
-   M-x cider-pprint-eval-last-sexp-to-comment

ãŸã ã—commentã¨åˆã‚ã›ã¦ä½¿ã†ã¨è©•ä¾¡ãŒå‹•ã‹ãªã„ã®ã§ã“ã‚Œã‚’ã¤ã‹ã†ã¨ãã¯commentã‚’å¤–ã™.


## Reloaded Workflow {#reloaded-workflow}

Stuart Sierraã•ã‚“ã®æå”±ã§æœ‰åã«ãªã£ãŸï¼Ÿé–‹ç™ºæ‰‹æ³•(2013).

ref: [ğŸ”—Clojure Workflow Reloaded](https://cognitect.com/blog/2013/06/04/clojure-workflow-reloaded)

Clojureã®èµ·å‹•,
ç‰¹ã«JVMã®åˆå›ç«‹ã¡ä¸Šã’ãŒé‡ãã¦æ°—è»½ã«å†èµ·å‹•ã§ããªã„ã‹ã‚‰ã“ãç”Ÿã¾ã‚ŒãŸå·¥å¤«.

ã‚¢ãƒ—ãƒªã‚’ã‚·ãƒ³ã‚°ãƒ«ãƒˆãƒ³ãªJVMã¨ã—ã¦èµ·å‹•ã™ã‚‹ã®ã§ã¯ãªãã¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¨ã—ã¦èµ·å‹•ã™ã‚‹ã“ã¨ã§å¤ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã¯æ¨ã¦ã¦ã—ã¾ã†(i.e.ã‚¬ãƒ¼ãƒ™ãƒ¼ã‚¸ã‚³ãƒ¬ã‚¯ã‚·ãƒ§ãƒ³ã‹ãª?).

ã¨ãã«resetã‚’é€£ç™ºã—ã¦ãƒ©ã‚¤ãƒˆã«ã‚·ã‚¹ãƒ†ãƒ å†èµ·å‹•,
CIDERã§ M-x cider-ns-refreshã®å‰å¾Œã«suspendã¨resumeã‚’hookã•ã›ã‚‹ã¨ã‚ˆã„ã¨ã‹.

.dir-locals.ã«è¨˜è¼‰.

```elisp
((clojure-mode . ((cider-ns-refresh-before-fn . "integrant.repl/suspend")
                  (cider-ns-refresh-after-fn  . "integrant.repl/resume"))))
```


### ğŸ’¡è€ƒå¯Ÿ: reloaded workflowã¯docker-composeã«ä¼¼ã¦ã„ã‚‹ {#è€ƒå¯Ÿ-reloaded-workflowã¯docker-composeã«ä¼¼ã¦ã„ã‚‹}

ã‚³ãƒ¬ã¯ãŸã—ã‹ã«ã‚ˆã„ã­, REPLã®å†èµ·å‹•ãŒçµæ§‹ã‚¹ãƒˆãƒ¬ã‚¹ã ã£ãŸã®ã§. reset é€£ç™ºã™ã‚‹ã.

docker-composeã«ç™ºæƒ³ã¯ä¼¼ã¦ã„ã‚‹ãª.
dockerã”ã¨ã«ã‚µãƒ¼ãƒ“ã‚¹ã‚’å®šç¾©ã—ã¦docker-composeã§ä¾å­˜é–¢ä¿‚ã‚’åˆ¶å¾¡ã—ã¤ã¤ç«‹ã¡ä¸Šã’ã‚‹ã¨ã“ã‚.
docker-composeã®å†èµ·å‹•ã£ã¦ã©ã®ãã‚‰ã„ã®é€Ÿã•ã ã£ã‘ï¼Ÿ

ã—ã‹ã—replã®ã¿ã§å†èµ·å‹•ã®ã»ã†ãŒé€Ÿãã†ã§ã¯ã‚ã‚‹.
ã‚·ã‚¹ãƒ†ãƒ ãƒ†ã‚¹ãƒˆãªã‚‰dockerã¾ã‚‹ã”ã¨å†èµ·å‹•ãŒå¿…è¦ã‚‚ã—ã‚Œãªã„ãŒå°‘ãªãã‚‚ã¨é–‹ç™ºãªã‚‰æ°—è»½ã«Emacsã‹ã‚‰å†èµ·å‹•ã—ãŸã„.


### See also {#see-also}

-   <https://github.com/weavejester/integrant-repl>
    -   integrantã«ãŠã„ã¦ reloaded workflowã‚’å®Ÿè·µ.
-   [Clojureã§å¿«é©ãªREPLé§†å‹•é–‹ç™ºã®ãŸã‚ã«"reloaded workflow"ã‚’å®Ÿè·µã—ã‚ˆã† - Qiita](https://qiita.com/lagenorhynque/items/a752ffae490e83ebe70d)
    -   <https://github.com/lagenorhynque/reloaded-workflow-examples>
-   [ãƒŸãƒ‹ãƒãƒªã‚¹ãƒˆã®ãŸã‚ã®Clojure REST APIé–‹ç™ºå…¥é–€2 ã€œãƒªãƒ•ã‚¡ã‚¯ã‚¿ãƒªãƒ³ã‚°ç·¨ã€œ - Qiita](https://qiita.com/lagenorhynque/items/f1e3c75439c1625756f3#2-integrant-repl%E3%81%AE%E5%B0%8E%E5%85%A5)
    -   integrant-repl deps.ednè¨­å®šä¾‹ãŒã‚ã£ãŸ.


## clojure.repl {#clojure-dot-repl}

Clojureã®REPLã§ã®ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ãƒ©ã‚¤ãƒ–ãƒ©ãƒª.

[clojure.repl - Clojure v1.10.3 API documentation](https://clojure.github.io/clojure/clojure.repl-api.html)

REPLã§requireã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’ä¸€åˆ‡åˆåˆ‡ãƒ­ãƒ¼ãƒ‰ã—ã¦ã¤ã‹ã†.

```clojure
(require '[clojure.repl :refer :all])
```

-   doc: é–¢æ•°ã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆã‚’è¡¨ç¤º.
    -   cider-doc/cider-clojuredocs/cider-javadocã ã¨EmacsçµŒç”±ã§å‚ç…§ã§ãã‚‹.
-   source: é–¢æ•°ã®ã‚½ãƒ¼ã‚¹ã‚’è¡¨ç¤º.


## Clojure RDD Tips {#clojure-rdd-tips}


### tips: ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ã‚’ã„ã‚ã„ã‚å°å…¥ {#tips-ä¾¿åˆ©ãƒ„ãƒ¼ãƒ«ã‚’ã„ã‚ã„ã‚å°å…¥}

REPLã‚’èµ·å‹•ã™ã‚‹ã¨user.cljãŒè‡ªå‹•çš„ã«èª­ã¿è¾¼ã¾ã‚Œã‚‹.
ä¾‹ãˆã°pathã« dev/srcã‚’è¨­å®šã—ã¦ãã®ä¸­ã« user.cljã‚’ãŠã„ã¦ãŠãã¨èª­ã¿è¾¼ã¾ã‚Œã‚‹.

ãã®user.cljã«REPLã§åˆ©ç”¨ã™ã‚‹ä¾¿åˆ©é–¢æ•°ã‚’ã„ã‚ã„ã‚è©°ã‚è¾¼ã‚“ã§ãŠãã¨,
è‡ªåˆ†å°‚ç”¨ã®é–‹ç™ºToolBoxã®å®Œæˆ.


### howto: namespaceã®å®šç¾©ã‚’æ¶ˆã—ãŸã„ {#howto-namespaceã®å®šç¾©ã‚’æ¶ˆã—ãŸã„}

clojure.coreã«ã¯, [ns-unmap](https://clojuredocs.org/clojure.core/ns-unmap) ãŒã‚ã‚Šã“ã‚Œã§namespaceã‹ã‚‰symbolã‚’æ¶ˆã™ã“ã¨ãŒã§ãã‚‹.

ciderã ã¨ cider-undefã‚’ã¤ã‹ã†ã¨better.


## å‚è€ƒãƒªãƒ³ã‚¯ {#å‚è€ƒãƒªãƒ³ã‚¯}

-   [Clojureã§REPLé§†å‹•é–‹ç™ºã‚’å§‹ã‚ã‚ˆã† - Qiita](https://qiita.com/lagenorhynque/items/d68934546fa7283bad9d)
-   [REPL Driven Programming - tyano's Techlog](https://tyano.shelfinc.com/post/48110396231/repl-driven-programming)
-   [REPL driven development Â· Practicalli Clojure](https://practical.li/clojure/repl-driven-development.html)
-   [An Architect's View: Talks: Clojure's Superpower](https://corfield.org/blog/2020/11/24/talks-clojures-superpower/)
    -   [Clojure-Provo December Meeting - REPL-Driven Development â€“ Clojure's
        Superpower - YouTube](https://www.youtube.com/watch?v=skEXGSp10Xs)
    -   [REPL Driven Development, Clojure's Superpower - Sean Corfield - YouTube](https://www.youtube.com/watch?v=gIoadGfm5T8)

---

see also: [ğŸ–ŠREPL é§†å‹•é–‹ç™ºã«ã¤ã„ã¦ï¼ˆREPL Driven Development) èª¿ã¹ãŸãƒ¡ãƒ¢ | Futurismo](https://futurismo.biz/archives/5717/)


## Active Recalls {#active-recalls}


### REPLã¨ã¯ä½•ã®ç•¥ã§ã™ã‹? {#replã¨ã¯ä½•ã®ç•¥ã§ã™ã‹}

read, evaluate, print, loop


### REPL Driven Developmentã¨ã¯ãªã‚“ã§ã™ã‹ï¼Ÿ {#repl-driven-developmentã¨ã¯ãªã‚“ã§ã™ã‹}

REPLã‚’ä½¿ã£ã¦å¯¾è©±çš„ã«é–‹ç™ºã‚’è¡Œã†æ‰‹æ³•.

ã‚¨ãƒ‡ã‚£ã‚¿ã«ã‚³ãƒ¼ãƒ‰ã‚’æ›¸ã„ã¦ï¼ŒREPLã«é€ä¿¡ã—ã¦è©•ä¾¡ã—ã¦å³åº§ã«ã‚¢ã‚¦ãƒˆãƒ—ãƒƒãƒˆã®ãƒ•ã‚£ãƒ¼ãƒ‰ãƒãƒƒã‚¯ã‚’å¾—ã‚‹ã“ã¨ã«ã§ï¼Œæ¬¡ã«ä½•ã‚’ã™ã‚‹ã‹ã‚’è€ƒãˆã‚‹ã“ã¨ãŒã§ãã‚‹.
