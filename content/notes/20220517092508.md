+++
title = "ğŸ“Clojure å‹ã¨ãƒ¬ã‚³ãƒ¼ãƒ‰ | Types, Records"
tags = ["WIKI"]
draft = false
+++

up: [ğŸ“Clojure Expression Problem]({{< relref "20220307162746.md" >}})


## Clojure ãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã¯ {#clojure-ãƒ¬ã‚³ãƒ¼ãƒ‰ã¨ã¯}

ãƒ‡ãƒ¼ã‚¿ã®æŠ½è±¡ã‚’æ‰±ã†betterãªãƒãƒƒãƒ—. (ref.[clojuredocs](https://clojuredocs.org/clojure.core/defrecord))

**defrecord** ã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§ï¼Œç‹¬è‡ªã®æŠ½è±¡ãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹ã“ã¨ãŒã§ãï¼Œã•ã‚‰ã«defprotocolã§å®šç¾©ã—ãŸãƒ¡ã‚½ãƒƒãƒ‰ã‚’çµ„ã¿è¾¼ã‚€ã“ã¨ãŒã§ãã‚‹.

å†…éƒ¨ã®ä»•çµ„ã¿ã§ã¯ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã—ã¦ã„ã‚‹ã®ã§Javaã®ã‚¯ãƒ©ã‚¹ã®ã‚ˆã†ã«OOãŒæŒã¤ç‰¹æ€§ãŒåˆ©ç”¨å¯èƒ½ã«ãªã‚‹ã¨ã„ã†ã‚ã‘ã (cf. **defstruct** ã§ã¯ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã—ãªã„ã®ã§ã“ã®ç‰¹æ€§ã¯åˆ©ç”¨ä¸å¯).

ref: [ğŸ’¡è€ƒå¯Ÿ: ãƒ‡ãƒ¼ã‚¿ã¨æ“ä½œã¯åˆ†ã‘ã‚‹ã‚’æ·±ã¼ã‚‹]({{< relref "20220309182946.md#è€ƒå¯Ÿ-clojureã®ãƒ‡ãƒ¼ã‚¿ã¨é–¢æ•°ã¯åˆ†ã‘ã‚‹ã‚’æ·±ã¼ã‚‹" >}})


## Clojure Record Basics {#clojure-record-basics}

defrecordã§å®šç¾©ã—ãŸFooã¨ã„ã†recordã«ã¯ ->Foo, map->Foo ã¨ã„ã†ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ãŒè‡ªå‹•ç”Ÿæˆã•ã‚Œã‚‹ãŸã‚ã“ã‚Œã‚’ã‚‚ã¡ã„ã‚‹ã“ã¨ã§Recordã‚’å¼•æ•°ä»˜ãã§ç”Ÿæˆã§ãã‚‹.

-   ->Foo ã¯ å¼•æ•°ã‹ã‚‰recordç”Ÿæˆ.
-   map->Fooã¯Mapã‹ã‚‰recordç”Ÿæˆ.

<!--listend-->

```clojure
(defrecord XYZ [foo bar])

(def xyz (->XYZ "foo" "bar"))

(:foo xyz)

(assoc xyz :boo "boo")
```

:keywordã§Recordã®ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’èª­ã‚€ã“ã¨ãŒã§ãã‚‹. .-:keywordã¯å¤ã„.

assocã‚„update-inã‚’åˆ©ç”¨ã™ã‚‹ã“ã¨ã§Recordã‚’æ›´æ–°ã™ã‚‹ã“ã¨ãŒã§ãã‚‹. ã“ã®å ´åˆ, æ–°ãŸãªRecordãŒè¿”ã•ã‚Œã‚‹([persistent]({{< relref "20220114074914.md#persistent" >}}) ãªClojureã®è¨­è¨ˆ). ãŸã ã—, dissocã«ã‚ˆã£ã¦ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã‚’å–ã‚Šé™¤ã“ã†ã¨ã™ã‚‹ã¨ãƒãƒƒãƒ—ãŒè¿”ã•ã‚Œã‚‹.

^Fooã®ã‚ˆã†ã« **^** ã‚’ã¤ã‹ã£ã¦å‹ãƒ’ãƒ³ãƒˆã«ä½¿ãˆã‚‹(ref:[Clojure:å‹ãƒ’ãƒ³ãƒˆ]({{< relref "20220117172324.md#clojure-å‹ãƒ’ãƒ³ãƒˆ--type-hinting" >}})).

recordåã¯å¤§æ–‡å­—ã‹ã‚‰å§‹ã¾ã‚‹ã“ã¨ãŒå¤šã„(Foo, Bar). ã“ã‚Œã‚‰ã¯æ…£ä¾‹ã§è¨€èªã®åˆ¶ç´„ã§ã¯ãªã„ãŒå¾“ã†ã»ã†ãŒã„ã„.


## Clojure Records Howto {#clojure-records-howto}


### ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ã‚ˆã†ã«Recordã‚’åˆæœŸåŒ–ã™ã‚‹ã«ã¯ï¼Ÿ {#ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ã‚ˆã†ã«recordã‚’åˆæœŸåŒ–ã™ã‚‹ã«ã¯}

Recordã¯Better Mapãªã®ã§åˆæœŸåŒ–ã§ã¯ãƒ‡ãƒ¼ã‚¿ã‚’æ ¼ç´ã™ã‚‹ã‚ˆã†ã«ã—ã‹IFãŒãªã£ã¦ãªã„. (->HOGEã‹, ã›ã„ãœã„map->HOGE).

ãã“ã§ãã“ã§æ…£ä¾‹çš„ã«ã‚ˆãã¿ã‹ã‘ã‚‹ã®ã¯ make-xxx ã¨ã„ã†é–¢æ•°ã‚’ä½œæˆã—ã¦, äº‹å‰ã«ã„ã‚ã„ã‚è¨ˆç®—ã—ã¦letã§ä¸€æ™‚å¤‰æ•°ã¨ã—ãŸã‚ã¨ã«ï¼Œæœ€å¾Œã«Recordã‚’ç”Ÿæˆã—ã¦ãã‚Œã‚’è¿”ã™helper é–¢æ•°ã‚’ä½œæˆã™ã‚‹.

```clojure
;;define Address record
(defrecord Address [city state])
;;define Person record
(defrecord Person [firstname lastname ^Address address])
;;buid the constructor
(defn make-person ([fname lname city state]
                   (->Person fname lname (->Address city state))))
;;create a person
(def person1 (make-person "John" "Doe" "LA" "CA"))
```

```clojure
(defn make-item
  [{:keys [id age] :as input}]
  {:pre [(string? id)
         (number? age)]}
  (-> input
      (update-in [:id] #(UUID/fromString %))
      (update-in [:age] int)
      my.model/map->Item))
```

ref. [Clojure: How to Hook into Defrecord Constructor](https://stackoverflow.com/questions/25983686/clojure-how-to-hook-into-defrecord-constructor)


### æ¡ä»¶ã«å¿œã˜ã¦Recordã‚’ç”Ÿæˆã™ã‚‹ã«ã¯ï¼Ÿ {#æ¡ä»¶ã«å¿œã˜ã¦recordã‚’ç”Ÿæˆã™ã‚‹ã«ã¯}

ã“ã‚Œã‚‚ **make-xxx** ã¿ãŸã„ãªæ„Ÿã˜ã§å†…éƒ¨å®Ÿè£…ã‚’éš è”½ã—ã¦ã¤ã¤ãƒ‘ãƒ©ãƒ¡ãƒ¼ã‚¿ã«ã‚ˆã£ã¦ç”Ÿæˆã™ã‚‹ãƒ¬ã‚³ãƒ¼ãƒ‰ã‚’è¿”ã™ã‚ˆã†ãªã‚‚ã®ã¯ã‚ˆãè¦‹ã‹ã‘ã‚‹.

ã“ã‚Œã¯ã„ã‚ã‚†ã‚‹ [Factory Method]({{< relref "20220309184220.md#factory-method" >}}) ã®ã‚ˆã†ã«ç”Ÿæˆã™ã‚‹ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’ã‚«ãƒ—ã‚»ãƒ«åŒ–ã™ã‚‹æ–¹æ³•.

ã“ã®å†…éƒ¨ã§ã•ã‚‰ã«multimedhodã‚’ã¤ã‹ã£ã¦dispatchã—ã¦ã‚‚ã‹ã£ã“ã„ã„ãŒãã‚Œã»ã©æ¡ä»¶åˆ†å²ãŒè¤‡é›‘ã§ãªã„ãªã‚‰condã§ã„ã„. ã‚‚ã†ã™ã§ã«make-xxxã§éš è”½ã—ã¦ã„ã‚‹ã¨ã“ã‚ã§è³¢ã„ã®ã§.


### ç•°ãªã‚‹namespaceã§å®šç¾©ã—ãŸRecordã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯ï¼Ÿ {#ç•°ãªã‚‹namespaceã§å®šç¾©ã—ãŸrecordã‚’åˆ©ç”¨ã™ã‚‹ã«ã¯}

ãªã‚“ã¨requireã§ã‚¨ãƒ©ãƒ¼ã‚’ã™ã‚‹. ãã®ç†ç”±ã¯, defrecordã¨ã¯ãƒã‚¯ãƒ­ã§ã‚ã‚Šãã®å®Ÿæ…‹ã¯Javaã‚¯ãƒ©ã‚¹ã®ç”Ÿæˆã§ã‚ã‚‹ãŸã‚, ã“ã‚Œã‚’namespaceã§ã¤ã‹ã†ã«ã¯requireã§ã¯ãªãimportãŒå¿…è¦ã‚‰ã—ã„(ãƒãƒã‚Šãƒã‚¤ãƒ³ãƒˆ).

-   refs.
    -   [Can't import clojure records - Stack Overflow](https://stackoverflow.com/questions/4580462/cant-import-clojure-records)
    -   [Using records from a different namespace in Clojure](https://puredanger.github.io/tech.puredanger.com/2010/06/30/using-records-from-a-different-namespace-in-clojure/)
        -   pure danger techã£ã¦ã‚¿ã‚¤ãƒˆãƒ«ãŒå±é™ºãã†w


### ä¸€éƒ¨ã®Recordã§åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ï¼Ÿ {#ä¸€éƒ¨ã®recordã§åŒã˜ãƒ‡ãƒ¼ã‚¿ã‚’å…±æœ‰ã™ã‚‹ã«ã¯}

åˆæœŸåŒ–å‡¦ç†ã®ãªã‹ã§ãªã‚“ã¨ã‹ã™ã‚‹.

ref. [ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ã‚ˆã†ã«Recordã‚’åˆæœŸåŒ–ã™ã‚‹ã«ã¯ï¼Ÿ](#ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã®ã‚ˆã†ã«recordã‚’åˆæœŸåŒ–ã™ã‚‹ã«ã¯)


### ä¸€éƒ¨ã®Recordã§åŒã˜protocolå®Ÿè£…ã‚’å…±æœ‰ã™ã‚‹ã«ã¯ï¼Ÿ {#ä¸€éƒ¨ã®recordã§åŒã˜protocolå®Ÿè£…ã‚’å…±æœ‰ã™ã‚‹ã«ã¯}

Recordã«ãƒ¡ã‚½ãƒƒãƒ‰ã‚’çµ„ã¿è¾¼ã‚€å ´åˆã¯Protocolã‚’ç”¨ã„ã‚‹ãŒ, ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«ã¯å®Ÿè£…ãŒå¿…è¦ã§ã‚ã‚Šå®šç¾©ã”ã¨ã«è¨˜è¿°ã™ã‚‹. è¤‡æ•°ã®Recordã®ã†ã¡ä¸€éƒ¨ã ã‘ãƒ¡ã‚½ãƒƒãƒ‰ã‚„å‡¦ç†å†…å®¹ãŒå…±é€šãªã®ã§å…±é€šåŒ–ã—ãŸã„å ´åˆ, ã¤ã¾ã‚Šdefault implementationã®ã‚ˆã†ãªã‚‚ã®ã‚’ã™ã‚‹å ´åˆ.

ref. [Clojure - mix protocol default implementation with custom implementation - Stack Overflow](https://stackoverflow.com/questions/15039431/clojure-mix-protocol-default-implementation-with-custom-implementation)

å·®åˆ†ã®ã‚ã‚‹éƒ¨åˆ†ã®ã¿protocolã§å®Ÿè£…ã—ã¦å…±é€šéƒ¨åˆ†ã¯ã‚ã–ã‚ã–protocolã«çµ„ã¿è¾¼ã‚€ã®ã§ã¯ãªãã¦å˜ç´”ãªé–¢æ•°ã¨ã—ã¦å®šç¾©ã™ã‚‹.

Clojureã®ä¸–ç•Œã¯å°‘æ•°ã®å‹ã¨ãã‚Œã‚’æ“ä½œã™ã‚‹ãŸãã•ã‚“ã®é–¢æ•°ã§ãªã‚ŠãŸã¤ãŸã‚, OOã®ä¸–ç•Œã®ã‚ˆã†ãªã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã ã‚‰ã‘ã®ä¸–ç•Œã¨ã¯ã¡ãŒã†.


## ğŸ’¡Clojure Records Insignts {#clojure-records-insignts}


### Thinking in Data {#thinking-in-data}

[Thinking in Data](https://www.infoq.com/presentations/Thinking-in-Data/), [Stuart Sierra]({{< relref "20220320182327.md" >}}) ã•ã‚“ã®è¬›æ¼”.

ãŠãã‚‰ãä¸€ç•ªã‚ã‹ã‚Šã‚„ã™ã‹ã£ãŸèª¬æ˜å‹•ç”».

ä»¥ä¸‹ã®ã“ã¨ã‚’å¼·çƒˆã«ä¸»å¼µ.

-   Everything is a Mapï¼Œå…¨ã¦ã¯Mapã§ã‚ã‚‹.OOPã‹ã‚‰æ¥ãŸäººãŸã¡ã¯ã™ãã«ã‚¯ãƒ©ã‚¹ã¿ãŸã„ãªãƒ‡ãƒ¼ã‚¿æ§‹é€ ã‚’å®šç¾©ã—ã‚ˆã†ã¨ã™ã‚‹ã‚“ã .
    -   Record Are Not Schemesï¼ŒRecordã¯ã‚¹ã‚­ãƒ¼ãƒã§ã¯ãªã„.
    -   ãªãœClojureã®Mapã‚’ã¤ã‹ã‚ãªã„ã‚“ã ï¼
    -   å®šç¾©ã™ã‚‹ã‚‚ã®ã¯ã‚ˆãè€ƒãˆã‚Œã°ã ã„ãŸã„ä¸è¦ã§ã—ã‚‡ã†.
    -   Recordã¯å¿…è¦ã«ãªã‚‹ã¾ã§å°å…¥ã—ãªã„.
    -   defrecordã§typoã—ãŸã‚‰ã©ã†ã™ã‚‹ï¼Ÿ
-   Recordã¯ä»¥ä¸‹ã®å ´åˆã®ã¿ã«ã¤ã‹ã†.
    -   å˜ãªã‚‹æ€§èƒ½ã®ãŸã‚ã®æœ€é©åŒ–.
    -   æ±ç”¨çš„ãªå‹•ä½œã‚’è¿½åŠ ã™ã‚‹å ´åˆã®ã¿åˆ©ç”¨ã™ã‚‹
-   ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ãƒƒã‚¯ã§ãªã„æ“ä½œã¯ã„ã‚‰ãªã„!

ã¤ã¾ã‚Šã›ã£ã‹ãClojureã®MapãŒç´ æ™´ã‚‰ã—ã„ã®ã§ãªãœãã‚Œã‚’ã¤ã‹ã‚ãªã„ã‚“ã ï¼Ÿã¨ã„ã†ã“ã¨.

ã‚·ãƒ³ãƒ—ãƒ«ã§ã©ã‚“ãªã‚±ãƒ¼ã‚¹ã«ã‚‚å¯¾å¿œã§ãã‚‹æ•°å€‹ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã¯, ã‚¯ã‚½ã¿ãŸã„ãª100å€‹ã®ã‚¯ãƒ©ã‚¹ã‚ˆã‚Šã‚‚åŠ›ãŒã‚ã‚‹.


### ğŸ’¡Joy of Clojureã‹ã‚‰ã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆ {#joy-of-clojureã‹ã‚‰ã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆ}

> å®Ÿè£…ãƒ¬ãƒ™ãƒ«ã§ã¯, mapã¯PersistentHashMap, ã¤ã¾ã‚Šã‚·ãƒ¼ã‚±ãƒ³ã‚¹. ä¸€æ–¹Recordã¯ã‚³ãƒ³ã‚¹ãƒˆãƒ©ã‚¯ã‚¿ã‚’ã‚‚ã¤Javaã‚¯ãƒ©ã‚¹ã¨ã—ã¦å®šç¾©ã•ã‚Œã‚‹.ã“ã®ã“ã¨ã«ã‚ˆã‚Š, ãƒ¡ãƒ¢ãƒªåŠ¹ç‡ã§ã¯Classã®ã»ã†ãŒå„ªã‚Œã¦ã„ã‚‹.

é–‹ç™ºã®ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆä½œæˆã«ãŠã„ã¦ã‚‚Recordã‚’ä½œæˆã—ã¦ç‰¹å®šã®è¦ç´ ã‚’å±æ€§ã«æŒãŸã›ãŸã»ã†ãŒã‚ˆã„ï¼Ÿ

ref. [ğŸ·The Joy of Clojure]({{< relref "20220405204228.md" >}})


### ğŸ’¡ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚° Clojureã‹ã‚‰ã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆ {#ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°-clojureã‹ã‚‰ã®ã‚¤ãƒ³ã‚µã‚¤ãƒˆ}

> ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ãƒ‰ãƒ¡ã‚¤ãƒ³ã®æƒ…å ±ã‚’ã‚¯ãƒ©ã‚¹ã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒ«åŒ–ã™ã‚‹ã“ã¨ã«ã¯æ¬ ç‚¹ãŒã‚ã‚‹. ãƒ‰ãƒ¡ã‚¤ãƒ³ã®çŸ¥è­˜ãŒ, ã‚¯ãƒ©ã‚¹ç‰¹æœ‰ã®setterã‚„getterã‹ã‚‰ãªã‚‹å°ã•ãªè¨€èªã®å½±ã«éš ã‚Œã¦ã—ã¾ã†ã®ã .
>
> æƒ…å ±ã‚’ä¸€èˆ¬åŒ–ã—ã¦æ‰±ã†ãƒ†ã‚¯ãƒ‹ãƒƒã‚¯ã¯ä½¿ã„ã¥ã‚‰ã, å¿…è¦ä»¥ä¸Šã«ãƒ‰ãƒ¡ã‚¤ãƒ³ã«ç‰¹åŒ–ã—ãŸã‚³ãƒ¼ãƒ‰ã‚’ã¡ã¾ã¡ã¾ã¨æ›¸ã‹ã–ã‚‹ã‚’å¾—ãªããªã‚Š, å†åˆ©ç”¨ã—ã«ãã„ã‚³ãƒ¼ãƒ‰ã‚’é‡ç”£ã™ã‚‹ç¾½ç›®ã«ãªã‚‹. ã“ã®ãŸã‚Clojureã§ã¯, ãƒ‰ãƒ¡ã‚¤ãƒ³ç‰¹æœ‰ã®æƒ…å ±ã¯ãªã‚‹ã¹ããƒãƒƒãƒ—ã‚’ä½¿ã£ã¦ãƒ¢ãƒ‡ãƒªãƒ³ã‚°ã™ã‚‹ã“ã¨ã‚’å¼·ãæ¨å¥¨ã—ã¦ã„ã‚‹. ã‚³ãƒ¬ã¯ãƒ‡ãƒ¼ã‚¿å‹ã«ã‚‚å½“ã¦ã¯ã¾ã‚‹. ãã“ã§ãƒ¬ã‚³ãƒ¼ãƒ‰ã®ç™»å ´ã .

ref. [ğŸ“šProgramming Clojure]({{< relref "20220307081341.md" >}})


### ğŸ¤”ãªãœ Mapã§ã¯ãªãRecordãªã®ã‹ï¼Ÿ {#ãªãœ-mapã§ã¯ãªãrecordãªã®ã‹}

> å…¨ä½“ã¨ã—ã¦ã€ãƒ¬ã‚³ãƒ¼ãƒ‰ã¯æƒ…å ±ã‚’æŒã¤ã‚ã‚‰ã‚†ã‚‹ç›®çš„ã§structmapã‚ˆã‚Šã‚‚å„ªã‚Œã¦ãŠã‚Šã€ãã®ã‚ˆã†ãªstructmapã¯defrecordã«ç§»è¡Œã™ã‚‹ã¹ãã ã€‚ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ãŸã‚ã®æ§‹é€ ã«structmapã‚’ä½¿ç”¨ã™ã‚‹å¯èƒ½æ€§ã¯ä½ã„ã ã‚ã†ãŒã€ãã®ã‚ˆã†ãªå ´åˆã«ã¯deftypeãŒã¯ã‚‹ã‹ã«å‘ã„ã¦ã„ã‚‹ã€‚

ref: [Clojure -ãƒ‡ãƒ¼ã‚¿å‹: ãƒ‡ãƒ¼ã‚¿å‹ã¨ãƒ—ãƒ­ãƒˆã‚³ãƒ«ã«ã¯å¼·ã„ä¸»å¼µãŒã‚ã‚‹](https://japan-clojurians.github.io/clojure-site-ja/reference/datatypes#_%E3%83%87%E3%83%BC%E3%82%BF%E5%9E%8B%E3%81%A8%E3%83%97%E3%83%AD%E3%83%88%E3%82%B3%E3%83%AB%E3%81%AB%E3%81%AF%E5%BC%B7%E3%81%84%E4%B8%BB%E5%BC%B5%E3%81%8C%E3%81%82%E3%82%8B)

---

> If you're making a new domain construct, you don't want low level. That was a mistake Java made, forcing programmers to write tons of domain classes and deck them out with getters. Each class was a new thing, incompatible with any existing tools. In Clojure, you use defrecord if you want to create a domain type. You can think of records like hashmaps but with their own class.

Javaç•Œéšˆã®äººã®é–“é•ã„ã¯ãƒ‰ãƒ¡ã‚¤ãƒ³ã”ã¨ã«å¤§é‡ã®recordã‚’å®šç¾©ã™ã‚‹. Clojureã§ã¯HashMapã§ã„ã„.

> Like hashmaps, they have equality and hash semantics defined for you, as you would expect. And they can store arbitrary data using the same access patterns as hashmaps. You can assoc, get, count, etc, on any record. Records will have their own class and can implement protocols and interfaces. So you get the best of using reusable data structures and type-based polymorphism. If you don't need the polymorphism, you should probably just use a hashmap.

ãƒãƒªãƒ¢ãƒ¼ãƒ•ã‚£ã‚ºãƒ ã‚’ã¤ã‹ã†äºˆå®šãŒãƒŠã‚±ã°hashmapã§ã„ã„.

ref. [deftype vs defrecord - Eric Normand](https://ericnormand.me/mini-guide/deftype-vs-defrecord)

---

recordã¯mapã®æ©Ÿèƒ½ã‚’å…¼ã­ã‚‹. å¤§ã¯å°ã‚’å…¼ã­ã¦ã‹ã¤ãƒ‡ãƒ¼ã‚¿ä¿æŒã¨ã—ã¦better
ãªã®ãŒRecordã¨ã„ã†è«–èª¿ã ãª.

ref: [clojure.core map]({{< relref "20220116080205.md#clojure-map--clojure-dot-core-dot-map" >}})

[Thinking in Data](#thinking-in-data) ã®å‹•ç”»ã‚’ã¿ã¦, å¿…è¦ã«ãªã‚‹ã¾ã§ã¯Recordã¯ä½¿ã‚ãªãã¦ã„ã„ã‚„ã¨æ€ã£ãŸ.


### ğŸ¤”ã‚¹ã‚³ãƒ¼ãƒ—ã‚’åˆ¶é™ã™ã‚‹ç›®çš„ãªã‚‰ã°Recordã§ã¯ãªãMapã‚’ã¤ã‹ã† {#ã‚¹ã‚³ãƒ¼ãƒ—ã‚’åˆ¶é™ã™ã‚‹ç›®çš„ãªã‚‰ã°recordã§ã¯ãªãmapã‚’ã¤ã‹ã†}

defrecordãŒå†…éƒ¨ã®åˆ¶å¾¡ã§ã‚¯ãƒ©ã‚¹ã‚’ç”Ÿæˆã™ã‚‹ã®ãªã‚‰ã°, ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘ã®ç›®çš„ã®ä¸€ã¤ã§ã‚ã‚‹å†åˆ©ç”¨å¯èƒ½ãªå‹ã‚’å®šç¾©ã—ã¦, ãã®å‹ã«å¾“ã£ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é‡ç”£ã™ã‚‹ã“ã¨ã‚’å‰æã¨ã™ã‚‹ã¯ãš.

namespace + defã«ã‚ˆã‚‹å®šæ•°å®£è¨€ã®ä»£æ›¿ã¨ã—ã¦, ã‚¹ã‚³ãƒ¼ãƒ—ã‚’çµã‚‹ç›®çš„ã§defrecordã‚’ã¤ã‹ãŠã†ã¨ã—ã¦ã„ãŸ(Cè¨€èªã®enumã®ã‚ˆã†ãªå®šæ•°ã®å®£è¨€ã‚’ã—ã‚ˆã†ã¨ã—ã¦ã„ãŸ)ãŒ, ã“ã‚Œã¯å˜ãªã‚‹å®šæ•°ã¨ã—ã¦ã®Mapãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ã„ã„ã ã‚ã†. ãã‚Œã‚‰ã®å‹ã‚’åˆ©ç”¨ã—ã¦ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã‚’é‡ç”£ã™ã‚‹ã‚ã‘ã§ã¯ãªã„ã®ã ã‹ã‚‰.


### ğŸ¤” åå‰ç©ºé–“(Namespaces)ã¨Recordã¯ä¼¼ã¦ã„ã‚‹ {#åå‰ç©ºé–“--namespaces--ã¨recordã¯ä¼¼ã¦ã„ã‚‹}

namespacesã¨ã„ã†ã®ãŒãƒ‡ãƒ¼ã‚¿ã¨æ“ä½œã®å¯¾å¿œã‚’ç’°å¢ƒã«bindingsã—ã¦ã„ã‚‹ã‚‚ã®ã¨ã¿ãŸã¨ã, Recordã¨Namespaceã¯ã«ã¦ã„ã‚‹ã¨ã„ãˆãªã„ã ã‚ã†ã‹ï¼Ÿ

ãƒ‰ãƒ¡ã‚¤ãƒ³é§†å‹•è¨­è¨ˆã«ãŠã‘ã‚‹ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’ãã®ã¾ã¾åå‰ç©ºé–“ã«ã—ã¦ãƒ‡ãƒ¼ã‚¿ã¨ãã®æ“ä½œã‚’namespaceã«bindingsã™ã‚Œã°ã‚ã–ã‚ã–Recordã‚’ã‚‚ã¡ã„ãªãã¦ã‚‚ã„ã„ã‹ã‚‚. åˆ¤æ–­åŸºæº–ã¯ã‚·ãƒ³ãƒ—ãƒ«ãªã‚‚ã®ã‚’é¸ã¶.

-   refs.
    -   [ğŸ“Clojure: åå‰ç©ºé–“(Namespaces)]({{< relref "20220116080418.md#clojure-åå‰ç©ºé–“--namespaces" >}})
    -   [ğŸ“Clojure Design Architecture]({{< relref "20220314120812.md" >}})


### ğŸ¤”ãªãœdeftypeã¨defrecordã®ï¼’ã¤ãŒã‚ã‚‹ã®ã‹ï¼Ÿ {#ãªãœdeftypeã¨defrecordã®ï¼’ã¤ãŒã‚ã‚‹ã®ã‹}

çµè«–, ã¨ã‚Šã‚ãˆãšå¿…è¦ã«ãªã‚‹ã¾ã§ã¯defrecordã‚’ã¤ã‹ã„deftypeã¯ä½¿ã‚ãªã„.

-   [clojure - deftype vs. defrecord - Stack Overflow](https://stackoverflow.com/questions/13150568/deftype-vs-defrecord)
-   [Clojure ã«ã¯ãªãœ5ã¤ã‚‚ã‚¯ãƒ©ã‚¹å®šç¾©ã™ã‚‹æ–¹æ³•ãŒã‚ã‚‹ã®ã‹ - æ—¥æ›œãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°](https://sunday-programming.hatenablog.com/entry/2013/10/04/105557)

deftypeã¯ä½ãƒ¬ãƒ™ãƒ«ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ å‘ã‘ã®ã‚‚ã®ã§, deftypeã‚’å…ƒã«defrecordãŒæ§‹ç¯‰ã•ã‚Œã¦ã„ã‚‹. deftypeã¯é–¢æ•°å€¤ã®ã¿ã‚’æ‰±ã†ãŸã‚ï¼Œå‘¼ã³å‡ºã—æ™‚ã®ã‚ªãƒ¼ãƒãƒ˜ãƒƒãƒ‰ã‚’ç¯€ç´„ã§ãã‚‹. ã—ã‹ã—ã»ã¨ã‚“ã©ã®å ´åˆ defrecordãŒã„ã„.

ä»¥ä¸‹ã®ãƒ•ãƒ­ãƒ¼ãƒãƒ£ãƒ¼ãƒˆã‚‚ã‚ã‹ã‚Šã‚„ã™ã„.

-   [Flowchart for choosing the right Clojure type definition form - Chas Emerick](https://cemerick.com/blog/2011/07/05/flowchart-for-choosing-the-right-clojure-type-definition-form.html)

---

ã»ã¨ã‚“ã©ã®ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆæŒ‡å‘è¨€èªã¯æ˜ç¢ºã«ä»¥ä¸‹ã®ï¼’ã¤ã‚’åˆ†é¡ã—ã¦è¨­è¨ˆã•ã‚Œã‚‹.

-   ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚‚ã®
-   ã‚¢ãƒ—ãƒªã‚±ãƒ¼ã‚·ãƒ§ãƒ³ã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã®ã‚‚ã®

ref: [ãªãœdeftypeã¨defrecordã®ä¸¡æ–¹ãŒã‚ã‚‹ã®ã‹?](https://japan-clojurians.github.io/clojure-site-ja/reference/datatypes#_%E3%81%AA%E3%81%9Cdeftype%E3%81%A8defrecord%E3%81%AE%E4%B8%A1%E6%96%B9%E3%81%8C%E3%81%82%E3%82%8B%E3%81%AE%E3%81%8B)

---

ãƒ—ãƒ­ã‚°ãƒ©ãƒŸãƒ³ã‚°ã®ã‚«ã‚¹ã‚¿ãƒ ãªãƒ‡ãƒ¼ã‚¿å‹ã‚’å®šç¾©ã™ã‚‹ã®ãŒdeftypeã§ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’å®šç¾©ã™ã‚‹ã®ãŒdefrecord.

> Summary: There are two commonly used ways to create new data types in Clojure, deftype and defrecord. They are similar but are intended to be used in two distinct use cases. deftype is for programming constructs and defrecord is for domain constructs.

ref. [deftype vs defrecord - Eric Normand](https://ericnormand.me/mini-guide/deftype-vs-defrecord)

---

è‡ªåˆ†ã®è§£é‡ˆã ã¨, Clojureãã®ã‚‚ã®ã®æ©Ÿèƒ½ã§ãƒ©ã‚¤ãƒ–ãƒ©ãƒªã‚’é–‹ç™ºã™ã‚‹ã®ã§ã¯ãªãã¦Clojureã§ã‚¢ãƒ—ãƒªã‚’ã¤ãã‚‹ç§ã®ã‚ˆã†ãªé–‹ç™ºè€…ã¯ã ã„ãŸã„defrecordã‚’ã¤ã‹ã£ã¦ã‚¢ãƒ—ãƒªã®ãƒ‰ãƒ¡ã‚¤ãƒ³ã‚’æ‰±ã†ã¹ãã ã¨ã„ã†ã“ã¨ã‹ãªï¼Ÿ

ãã—ã¦ã‚¬ãƒé–‹ç™ºã§ãªãã•ãã£ã¨Clojureã‚’æ›¸ãç¨‹åº¦ãªã‚‰ã°mapã§ååˆ†. è¤‡é›‘ã•ã‚’å›é¿ã™ã‚‹ãŸã‚ã®æŠ½è±¡åŒ–ã¯å‹•çš„è¨€èªã§ã•ãã£ã¨é–‹ç™ºã™ã‚‹ã«ã¯é©ã•ãªã„.


### ğŸ’¡defstructã¯å¤ã„(deplicated) {#defstructã¯å¤ã„--deplicated}

defrecordã¯æ§‹é€ ä½“ã®æ©Ÿèƒ½ã‚’æä¾›ã™ã‚‹ãŒ, defrecordã®ç™»å ´ã«ã‚ˆã£ã¦defstructã¯ä¸è¦ãªæ–¹å‘ã¸å‘ã‹ã£ã¦ã„ã‚‹ã‚‰ã—ã„. ClojureScriptã§ã¯defstructã¯æ¡ç”¨ã•ã‚Œã¦ã„ãªã„.

[ğŸ“šProgramming Clojure(2nd)]({{< relref "20220307081341.md" >}})ã§ã¯ã—ã°ã—ã°defstructãŒç™»å ´ã—ã¦ã„ãŸãŒã“ã‚Œã¯defrecordã§ç½®ãæ›ãˆãŸã»ã†ãŒè‰¯ã•ãã†ğŸ¤”.

-   refs.
    -   [What was the reasoning behind ClojureScript not needing Clojure's defstruct? - Stack Overflow](https://stackoverflow.com/questions/23147764/what-was-the-reasoning-behind-clojurescript-not-needing-clojures-defstruct)
    -   [Most uses of StructMaps would now be better served by records](https://clojure.org/reference/data_structures#StructMaps)
