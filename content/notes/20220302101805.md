+++
title = "ğŸ“Clojure Idioms"
tags = ["WIKI"]
draft = false
+++

refs: [ğŸ“‚Clojure Core]({{< relref "20220112142936.md" >}}) [ğŸ·Clojure]({{< relref "20211111225741.md" >}})

Clojureã®ä¸»ã«ãƒ‡ãƒ¼ã‚¿æ“ä½œã«é–¢ã™ã‚‹å°æŠ€ã‚’æ›¸ãæºœã‚ã¦ã„ã.

Ankiã«çªã£è¾¼ã‚€ã“ã¨ã§è¨˜æ†¶ã‚‚ã—ã¦ã„ã.


## andã¨orã‚’æ¡ä»¶åˆ†å²ã«ã¤ã‹ã† {#andã¨orã‚’æ¡ä»¶åˆ†å²ã«ã¤ã‹ã†}

-   orã«å½“ãŸã‚‰ãˆã‚ŒãŸå¼ã§çœŸã«ãªã‚‹ã‚‚ã®ãŒè¦‹ã¤ã‹ã£ãŸã‚‰æ®‹ã‚Šã‚’è©•ä¾¡ã›ãšã«çœŸã‚’è¿”ã™.
    -   ex. [yogthos/config](https://github.com/yogthos/config/blob/81750c8fdb946050a8074f14ab03c8b226536b1a/src/config/core.clj#L57)
-   andã«å½“ãŸã‚‰ãˆã‚ŒãŸå¼ã§å½ã«ãªã‚‹ã‚‚ã®ãŒè¦‹ã¤ã‹ã‚‰ãªã„é™ã‚Šæ®‹ã‚Šã‚’è©•ä¾¡ã™ã‚‹.

ref: [ğŸ“šLand of Lisp]({{< relref "20211113235959.md" >}}) p47ã«æ›¸ã„ã¦ã‚ã£ãŸ.


## ãƒã‚¹ãƒˆã—ãŸCollectionæ“ä½œã«get-in/assoc-in/update-in {#ãƒã‚¹ãƒˆã—ãŸcollectionæ“ä½œã«get-in-assoc-in-update-in}

get-in/assoc-in/update-in ã‚’ã¤ã‹ã†.

<https://clojuredocs.org/clojure.core/assoc-in>

```clojure
;; assoc-in into a nested map structure
(def foo {:user {:bar "baz"}})
(assoc-in foo [:user :id] "some-id")
;;=> {:user {:bar "baz", :id "some-id"}}
```

ref: [ğŸ“Clojure Map(clojure.core.map)]({{< relref "20220116080205.md#clojure-map--clojure-dot-core-dot-map" >}})


## é–¢æ•°ã®å¼•æ•°ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æŒ‡å®šã™ã‚‹ã«ã¯ï¼Ÿ {#é–¢æ•°ã®å¼•æ•°ã«ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå€¤ã‚’æŒ‡å®šã™ã‚‹ã«ã¯}

ã„ã‚ã‚†ã‚‹ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå¼•æ•°ã¨ã„ã†ã‚‚ã®ã ãŒ,
ä½ç½®å¼•æ•°ã«å€¤ã‚’è¨­å®šã™ã‚‹æ–¹æ³•ã¯è¦‹å½“ãŸã‚‰ãªã„(è¦‹ã¤ã‘ã‚‰ã‚Œã¦ãªã„ã ã‘ã‹ã‚‚).

ä»£ã‚ã‚Šã«ã‚ªãƒ—ã‚·ãƒ§ãƒ³å¼•æ•°ã¨ [ã‚­ãƒ¼ãƒ¯ãƒ¼ãƒ‰å¼•æ•°]({{< relref "20220305075933.md#é–¢æ•°ã®å¼•æ•°" >}}) ã®æ–‡æ³•ã®çµ„ã¿åˆã‚ã›ã§ã§ãã‚‹.

[åˆ†é…æŸç¸›(Destructuring)]({{< relref "20220116094551.md#clojure-åˆ†é…æŸç¸›--destructuring" >}}) ã® **or** ã‚’æ´»ç”¨ã™ã‚‹.

```clojure
(defn myfunc
  [arg & {:keys [opt1 opt2] :or {opt1 "default1" opt2 "default2"}}]
  (format "arg=[%s] opt1=[%s] opt2=[%s]" arg opt1 opt2))

(myfunc "argument" {:opt1 "option1"})
;; => "arg=[argument] opt1=[option1] opt2=[default2]"
```


## select-keys: ã‚ã‚‹Mapã‹ã‚‰keywordã‚’æŒ‡å®šã—ã¦SubMapã‚’ä½œæˆ {#select-keys-ã‚ã‚‹mapã‹ã‚‰keywordã‚’æŒ‡å®šã—ã¦submapã‚’ä½œæˆ}

<https://clojuredocs.org/clojure.core/select-keys>

```clojure
(select-keys {:a 1 :b 2} [:a])
;;=> {:a 1}
```


## fnil: Nilã‚’ åˆæœŸå€¤ã§ç½®ãæ›ãˆã¦é–¢æ•°é©ç”¨ {#fnil-nilã‚’-åˆæœŸå€¤ã§ç½®ãæ›ãˆã¦é–¢æ•°é©ç”¨}

<https://clojuredocs.org/clojure.core/fnil>

ãƒ‡ãƒ¼ã‚¿æ“ä½œã‚’ã—ã‚ˆã†ã¨ã—ãŸã¨ãã«,
å¼•æ•°ã§ã‚‚ã‚‰ã£ãŸãƒ‡ãƒ¼ã‚¿æ§‹é€ ãŒnilã®å ´åˆã¯åˆæœŸå€¤ã®ãƒ‡ãƒ¼ã‚¿æ§‹é€ ã§ç½®ãæ›ãˆã‚‹.

```clojure
(update request ::acc (fnil conj []) id)
```

ã“ã‚Œã®ã‚„ã‚ã†ã¨ã—ã¦ã„ã‚‹ã“ã¨ã¯,
request mapã® ::accã¨ã„ã†ãƒ•ã‚£ãƒ¼ãƒ«ãƒ‰ã«ã‚ã‚‹vectorã«idã‚’è¿½åŠ ã—ã‚ˆã†ã¨ã™ã‚‹ãŒ,
:acc ãŒrequest mapã«ãªã„ã¨ãã¯ç©ºã®vectorã‚’ç”¨æ„ã—ã¦ã•ã‚‰ã«idã‚’åŠ ãˆã‚‹.


## References {#references}

-   [ã‚¤ãƒ‡ã‚£ã‚ªãƒ é›† â€” Clojure ã®æ—¥æœ¬èªã‚¬ã‚¤ãƒ‰](https://ayato-p.github.io/clojure-beginner/idioms/index.html)
-   [1ãƒ¶æœˆé–“ä»•äº‹ã§Clojureã‚’æ›¸ã„ã¦ã„ã‚‹ä»Šæ™‚ç‚¹ã§ã‚ˆãä½¿ã†é–¢æ•°ãƒ»ã‚³ãƒãƒ³ãƒ‰ã¾ã¨ã‚ - Qiita](https://qiita.com/makinoshi/items/a4393784b9532d6a9f22)
-   [filter ã¨ remove ã®ãµãŸã¤ã®çµæœã‚’ç°¡å˜ã«å—ã‘å–ã‚‹æ–¹æ³• - Qiita](https://qiita.com/ayato_p/items/db4d6bd8d453f14e13e2)
-   [Clojure Destructuring Tutorial and Cheat Sheet Â· GitHub](https://gist.github.com/john2x/e1dca953548bfdfb9844)
